webshim.register("sticky",function(a,b,c,d){"use strict";function e(a,b,c){var e=a+":",f=d.createElement("test"),g=f.style;return g.cssText=c?e+b:e+["-webkit-","-moz-","-ms-","-o-",""].join(b+";"+e)+b+";",g[a]}function f(){return{top:a.css(this,"top"),bottom:a.css(this,"bottom")}}function g(b){h++,i++,this.evtid=".wsstickyid"+h,this.$el=a(b).data("wsSticky",this),this.$parent=this.$el.parent(),this.elStyle=b.style,this.ankered="",this.isSticky=!1,this.$placeholder=null,this.testParentOverflow(),this.addEvents(),this.update(!0)}var h=0,i=0,j=a(c),k=function(){var a,b="pageYOffset";return b in c?function(){return c[b]}:(a=d.documentElement,function(){return a.scrollTop()})}(),l={fixed:e("position","fixed",!0),sticky:e("position","sticky")};g.prototype={addEvents:function(){var b=this,c=function(){b.update()};j.on("scroll"+this.evtid,function(){b.ankered&&b.$el[0].offsetWidth&&b.updatePos()}).one("load",c),a(d).on("updateshadowdom"+this.evtid,c),this.$el.on("remove"+this.evtid+" destroysticky"+this.evtid,function(){j.off(b.evtid),a(d).off(b.evtid),b.$el.off(b.evtid),b.$el.removeData("wsSticky"),b.$placeholder&&(b.$el.removeClass("ws-sticky-on"),b.$placeholder.remove()),i--}),this.$el.on("updatesticky"+this.evtid,function(){b.update(!0)})},testParentOverflow:function(){var a=this.$parent.css("overflowY")||this.$parent.css("overflow")||"visible";"visible"!==a?(this.scrollMode="element",this.$scrollContainer=this.$parent):(this.scrollMode="window",this.getScrollTop=k,this.$scrollContainer=j)},getScrollTop:function(){return this.$parent[0].scrollTop},trashPosition:function(){var a=this.isMoving;this.isMoving=!1,this.getPosition(),this.isMoving=a,this.updateDimension(!0),this.updatePos()},getPosition:function(){this.isMoving||(this.position={top:this.$el.css("top"),bottom:this.$el.css("bottom")},!this.isSticky&&("auto"!=this.position.top&&"auto"!=this.position.bottom||"auto"==this.position.top&&"auto"==this.position.bottom)&&(this.position=a.swap(this.$el[0],{position:"absolute"},f)),"auto"!==this.position.top?(delete this.position.bottom,this.ankered="top"):"auto"!==this.position.bottom&&(delete this.position.top,this.ankered="bottom"),"top"==this.ankered?this.position.top=parseFloat(this.position.top,10)||0:"bottom"==this.ankered&&(this.position.bottom=parseFloat(this.position.bottom,10)||0),this.inlineTop=this.elStyle.top,this.inlineBottom=this.elStyle.bottom)},updateDimension:function(){this.elOuterHeight=this.$el.outerHeight();var a=this.$parent.offset().top;this.isSticky?this.$parent.innerWidth()<this.elWidth&&(this.elWidth=this.$el.width(this.$placeholder.width()).width()):(this.elTop=this.$el.offset().top,this.elWidth=this.$el.width(),this.inlineWidth=this.elStyle.width),"bottom"==this.ankered?(this.viewportBottomAnker=j.height()-this.position.bottom,this.viewportTopAnker=a+(parseFloat(this.$parent.css("borderTopWidth"),10)||0)+(parseFloat(this.$parent.css("paddingTop"),10)||0),this.elBottom=this.elTop+this.elOuterHeight):this.parentBottom=a+this.$parent.innerHeight()-(parseFloat(this.$parent.css("paddingBottom"),10)||0)+(parseFloat(this.$parent.css("borderBottomWidth"),10)||0)},updatePos:function(){var a,b,c,d=this.getScrollTop();"top"==this.ankered?(a=d+this.position.top,this.elTop<a&&a-9<=this.parentBottom&&(c=a+this.elOuterHeight-this.parentBottom,c>0?c*=-1:c=!1,b=!0)):"bottom"==this.ankered&&(a=d+this.viewportBottomAnker,this.elBottom>a&&a>=this.viewportTopAnker&&(b=!0,c=a-this.viewportTopAnker-this.elOuterHeight,c>0&&(c=!1))),b?(this.isSticky||(this.updateDimension(),this.$placeholder||(this.$placeholder=this.$el.clone().addClass("ws-fixedsticky-placeholder").insertAfter(this.$el)),this.$placeholder.outerHeight(this.elOuterHeight),this.isSticky=!0,this.$el.addClass("ws-sticky-on"),this.elWidth!=this.$el.width()&&this.$el.width(this.elWidth)),c&&(this.isMoving=!0,"top"==this.ankered?this.elStyle.top=this.position.top+c+"px":"bottom"==this.ankered&&(this.elStyle.bottom=this.position.bottom+c+"px"))):this.isSticky&&(this.$el.removeClass("ws-sticky-on"),this.$el.css({width:this.inlineWidth||"",top:this.inlineTop||"",bottom:this.inlineBottom||""}),this.isSticky=!1,this.isMoving=!1)},update:function(a){(this.$el[0].offsetWidth||!this.ankered)&&(a&&this.getPosition(),this.updateDimension(a),this.updatePos(a))}};var m=function(){m=a.noop,b.ready("WINDOWLOAD",function(){b.loader.loadList(["dom-extend"]),b.ready("dom-extend",function(){b.addShadowDom()})})},n=function(){a.data(this,"wsSticky")||(new g(this),m())};!l.sticky&&l.fixed&&a(function(){b.addReady(function(b,c){a(".ws-sticky",b).add(c.filter(".ws-sticky")).each(n)})})});