webshims.register("jme",function(a,b,c,d,e){"use strict";var f={},g={},h=Array.prototype.slice,i=a.extend({selector:".mediaplayer"},b.cfg.mediaelement.jme);b.cfg.mediaelement.jme=i,a.jme={plugins:{},data:function(b,c,d){var f=a(b).data("jme")||a.data(b,"jme",{});return d===e?c?f[c]:f:(f[c]=d,void 0)},registerPlugin:function(b,c){this.plugins[b]=c,c.nodeName||(c.nodeName=""),c.className||(c.className=b),i[b]=a.extend(c.options||{},i[b]),i[b]&&i[b].text?c.text=i[b].text:i.i18n&&i.i18n[b]&&(c.text=i.i18n[b])},defineMethod:function(a,b){g[a]=b},defineProp:function(b,c){c||(c={}),c.set||(c.set=c.readonly?function(){throw b+" is readonly"}:a.noop),c.get||(c.get=function(c){return a.jme.data(c,b)}),f[b]=c},prop:function(b,c,d){if(!f[c])return a.prop(b,c,d);if(d===e)return f[c].get(b);var g=f[c].set(b,d);g===e&&(g=d),"noDataSet"!=g&&a.jme.data(b,c,g)}},a.fn.jmeProp=function(b,c){return a.access(this,a.jme.prop,b,c,arguments.length>1)},a.fn.jmeFn=function(b){var c,d=h.call(arguments,1);return this.each(function(){return c=(g[b]||a.prop(this,b)).apply(this,d),c!==e?!1:void 0}),c!==e?c:this};var j={emptied:1,pause:1},k={canplay:1,canplaythrough:1},l=i.selector;a.jme.initJME=function(b,c){a(l,b).add(c.filter(l)).jmePlayer()},a.jme.getDOMList=function(b){var c=[];return b||(b=[]),"string"==typeof b&&(b=b.split(" ")),a.each(b,function(a,b){b&&(b=document.getElementById(b),b&&c.push(b))}),c},a.jme.getButtonText=function(b,c){var d,e,f=function(f){e!==f&&(e=f,b.removeClass(c[f?0:1]).addClass(c[f]),d&&(b.prop("checked",!!f),(b.data("checkboxradio")||{refresh:a.noop}).refresh()))};return b.is('[type="checkbox"], [type="radio"]')?(b.prop("checked",function(){return this.defaultChecked}),d=!0):b.is("a")&&b.on("click",function(a){a.preventDefault()}),f},a.fn.jmePlayer=function(c){return this.each(function(){c&&a.jme.data(this,a.extend(!0,{},c));var d,e,f,g,h,l,m=a("audio, video",this).eq(0),n=a(this),o=a.jme.data(this),p=a.jme.data(m[0]);n.addClass(m.prop("nodeName").toLowerCase()+"player"),p.player=n,p.media=m,o.media||(f=function(){m.off("canplay",e),clearTimeout(g)},e=function(){var a=m.prop("paused")?"idle":"playing";n.attr("data-state",a)},d=function(b){var c,d,h=b.type;f(),k[h]&&"waiting"!=l||("ended"==h||a.prop(this,"ended")?h="ended":"waiting"==h?a.prop(this,"readyState")>2?h="":(g=setTimeout(function(){m.prop("readyState")>2&&e()},9),m.on("canPlay",e)):j[h]?h="idle":(c=a.prop(this,"readyState"),d=a.prop(this,"paused"),h=!d&&3>c?"waiting":!d&&c>2?"playing":"idle"),"idle"==h&&n._seekpause&&(h=!1),h&&(l=h,n.attr("data-state",h)))},h=function(){var a,b=[{size:380,name:"x-small"},{size:490,name:"small"},{size:756,name:"medium"},{size:1024,name:"large"}],c=b.length;return function(){for(var d="x-large",e=0,f=n.outerWidth();c>e;e++)if(b[e].size>=f){d=b[e].name;break}a!=d&&(a=d,n.attr("data-playersize",d))}}(),o.media=m,o.player=n,m.on("ended emptied play",function(){var a,b=function(){f(),m.jmeFn("pause"),i.noReload||!m.prop("ended")||!m.prop("paused")||m.prop("autoplay")||m.prop("loop")||m.hasClass("no-reload")||(m.jmeFn("load"),n.attr("data-state","ended"))};return function(c){clearTimeout(a),"ended"!=c.type||i.noReload||m.prop("autoplay")||m.prop("loop")||m.hasClass("no-reload")||(a=setTimeout(b))}}()).on("emptied waiting canplay canplaythrough playing ended pause mediaerror",d).on("volumechange updateJMEState",function(){var b=a.prop(this,"volume");n[!b||a.prop(this,"muted")?"addClass":"removeClass"]("state-muted"),b=.01>b?"no":.36>b?"low":.7>b?"medium":"high",n.attr("data-volume",b)}),n.on({useractive:function(){n.attr("data-useractivity","true")}}).on("userinactive",{idletime:3500},function(){n.attr("data-useractivity","false")}).triggerHandler("userinactive"),h(),b.ready("dom-support",function(){n.onWSOff("updateshadowdom",h),b.addShadowDom()}),d&&m.on("updateJMEState",d).triggerHandler("updateJMEState"))})},a.jme.defineProp("isPlaying",{get:function(b){return!a.prop(b,"ended")&&!a.prop(b,"paused")&&a.prop(b,"readyState")>1&&!a.data(b,"mediaerror")},readonly:!0}),a.jme.defineProp("player",{readonly:!0}),a.jme.defineProp("media",{readonly:!0}),a.jme.defineProp("srces",{get:function(b){var c,d=a.jme.data(b),e=d.media.prop("src");return e?[{src:e}]:c=a.map(a("source",d.media).get(),function(b){var c={src:a.prop(b,"src")},d=a.attr(b,"media");return d&&(c.media=d),d=a.attr(b,"type"),d&&(c.type=d),c})},set:function(b,c){var d=a.jme.data(b),e=function(b,c){"string"==typeof c&&(c={src:c}),a(document.createElement("source")).attr(c).appendTo(d.media)};return d.media.removeAttr("src").find("source").remove(),a.isArray(c)?a.each(c,e):e(0,c),d.media.jmeFn("load"),"noDataSet"}}),a.jme.defineMethod("togglePlay",function(){a(this).jmeFn(f.isPlaying.get(this)?"pause":"play")}),a.jme.defineMethod("addControls",function(b){var c=a.jme.data(this)||{};if(c.media){var d=a.jme.data(c.player[0],"controlElements")||a([]);b=a(b),a.each(a.jme.plugins,function(d,e){b.filter("."+e.className).add(b.find("."+e.className)).each(function(){var b=a(this),d=a.jme.data(this);d.player=c.player,d.media=c.media,d._rendered||(d._rendered=!0,e.options&&a.each(e.options,function(a,b){a in d||(d[a]=b)}),e._create(b,c.media,c.player,d),b=null)})}),a.jme.data(c.player[0],"controlElements",d.add(b)),c.player.triggerHandler("controlsadded")}}),function(){var b={add:function(b,c,d){var e,f,g=a.data(b,"jmeuseractivity")||a.data(b,"jmeuseractivity",{idletime:2500,idle:!0,trigger:{}}),h=a(b),i=function(){g.idle||(g.idle=!0,g.trigger.userinactive&&h.trigger("userinactive"))},j=function(a){!a||"mousemove"===a.type&&a.pageX===e&&a.pageY===f||("mousemove"===a.type&&(e=a.pageX,f=a.pageY),g.idleTimer&&clearTimeout(g.idleTimer),g.idleTimer=setTimeout(i,g.idletime),g.idle&&(g.idle=!1,g.trigger.useractive&&h.trigger("useractive")))};g.idletime=(c||{}).idletime||g.idletime,c&&"idle"in c&&(g.idle=c.idle),g.trigger[d]=!0,g.bound||(h.on("mouseleave.jmeuseractivity",i).on("mousemove.jmeuseractivity focusin.jmeuseractivity mouseenter.jmeuseractivity keydown.jmeuseractivity keyup.jmeuseractivity mousedown.jmeuseractivity",j),g.bound=!0),g.idle||j({type:"initunidled"})},remove:function(b,c){var d=a.data(b,"jmeuseractivity")||a.data(b,"jmeuseractivity",{idletime:2500,idle:!0,trigger:{}});d.trigger[c]=!1,d.trigger.useractive||d.trigger.userinactive||(a(b).off(".jmeuseractivity"),d.bound=!1)}};a.each(["useractive","userinactive"],function(c,d){a.event.special[d]={setup:function(a){b.add(this,a,d)},teardown:function(){b.remove(this,d)}}})}(),b.ready("mediaelement",function(){b.addReady(a.jme.initJME)}),b._polyfill(["mediaelement"])}),webshims.register("playlist",function(a){"use strict";function b(a){this._data=a,this._autoplay=null,this.lists={},this.on("showcontrolschange",this._updateControlsClass)}function c(b,d,e){this.list=b||[],this.playlists=d,this.media=d._data.media,this.player=d._data.player,this.options=a.extend(!0,{},c.defaults,e),this.options.itemTmpl=this.options.itemTmpl.trim(),this.deferred=a.Deferred(),this._selectedIndex=-1,this._selectedItem=null,this.$rendered=null,this._detectListType(),this.autoplay(this.options.autoplay),this.deferred.done(function(){this._addEvents(this),"auto"!=this.options.defaultSelected||this.media.jmeProp("srces").length||(this.options.defaultSelected=0),this.list[this.options.defaultSelected]&&this.selectedIndex(this.options.defaultSelected),this._fire("addlist")})}function d(a){return a.description=a.description||a.content,a.srces=[],(a.mediaGroups||[]).forEach(function(b){(b.contents||[]).forEach(function(b){b.src=b.src||b.url,a.srces.push(b)})}),a}function e(){return{src:a.attr(this,"href"),srclang:a.attr(this,"lang"),label:a.attr(this,"data-label")}}function f(){return{src:a.attr(this,"url")||a.attr(this,"href"),type:a.attr(this,"type")}}function g(){return 1==this.nodeType}var h=a.jme,i=0,j='<button class="{%class%}" type="button" aria-label="{%text%}"></button>';a.extend(b.prototype,{on:function(){a.fn.on.apply(a(this),arguments)},off:function(){a.fn.off.apply(a(this),arguments)},_getListId:function(a){var b;return b="string"==typeof a?a:a.id},_updateControlsClass:function(){this._data.player[this.getShowcontrolsList()?"addClass":"removeClass"]("has-playlist")},add:function(a,b){return a=new c(a,this,b),a.id||(i++,a.id="list-"+i),this.lists[a.id]=a,a.options.showcontrols&&this._data.player.addClass("has-playlist"),a},remove:function(a){var b=this._getListId(a);this.lists[b]&&(this.lists[b]._remove(),delete this.lists[b]),this.getShowcontrolsList()||this._data.player.removeClass("has-playlist")},getAutoplayList:function(){var b=null;return a.each(this.lists,function(a,c){return c.options.autoplay?(b=c,!1):void 0}),b},getShowcontrolsList:function(){var b=null;return a.each(this.lists,function(a,c){return c.options.showcontrols?(b=c,!1):void 0}),b}}),c.getText=function(a){return a.attr("content")||(a.text()||"").trim()},c.getUrl=function(a){return a.attr("content")||a.attr("url")||a.attr("href")||a.attr("src")||(a.text()||"").trim()},c.defaults={loop:!1,autoplay:!1,defaultSelected:"auto",addItemEvents:!0,showcontrols:!0,ajax:{},itemTmpl:'<li class="list-item"><% if(typeof poster == "string" && poster) {%><img src="<%=poster%>" /><% }%><h3><%=title%></h3><% if(typeof description == "string" && description) {%><div class="item-description"><%=description%></div><% }%></li>',renderer:function(b,c){return a.jme.tmpl(c,b)},mapDom:function(b){return{title:c.getText(a('[itemprop="name"], h1, h2, h3, h4, h5, h6, a',b)),srces:a('[itemprop="contentUrl"], a[type^="video"], a[type^="audio"]',b).map(function(){var d,e={src:c.getUrl(a(this))};return d="a"==this.nodeName.toLowerCase()?a.prop(this,"type"):c.getText(a('[itemprop="encodingFormat"]',b)),d&&(e.type=d),d=a.attr(this,"data-media"),d&&(e.media=d),e}).get(),tracks:a('a[type="text/vtt"]').map(e).get(),poster:c.getUrl(a('[itemprop="thumbnailUrl"], a[type^="image"], img',b))||null,description:c.getText(a('[itemprop="description"], .item-description, p',b))||null}},mapUrl:function(b,g){a.ajax(a.extend(b,{success:function(b){var h;a.isArray(b)?h=b:b.responseData&&b.responseData.feed?(b=b.responseData.feed,h=(b.entries||[]).map(d)):(h=[],a("item",b).each(function(){var b=a("enclosure, media\\:content",this).filter('[type^="video"], [type^="audio"]').map(f).get();b.length&&h.push({title:a("title",this).html(),srces:b,publishedDate:a("pubDate",this).html()||null,description:a("description",this).text()||null,poster:c.getUrl(a('itunes\\:image, media\\:thumbnail, enclosure[type^="image"], media\\:content[type^="image"]',this))||null,author:a("itunes\\:author",this).html()||null,duration:a("itunes\\:duration",this).html()||null,tracks:a("media\\:subTitle",this).map(e).get()||null})})),h!=b&&(h.fullData=b),g(h)}}))}},a.extend(c.prototype,{on:function(){a.fn.on.apply(a(this),arguments)},off:function(){a.fn.off.apply(a(this),arguments)},_detectListType:function(){var a;return"string"==typeof this.list?(this._createListFromUrl(),void 0):(this.list.nodeName||this.list.length>0&&this.list[0].nodeName?this._createListFromDom():this.list.responseData&&this.list.responseData.feed&&(a=this.list.responseData.feed,this.list=(a.entries||[]).map(d),this.list.fullData=a),this.deferred.resolveWith(this),void 0)},_createListFromUrl:function(){var a=this;this.options.ajax.url=this.list,this.options.mapUrl(this.options.ajax,function(b){a.list=b,a.deferred.resolveWith(a)})},_createListFromDom:function(){var b=this;this.$rendered=a(this.list).eq(0),this.list=[],this.$rendered&&(this._addDomList(),this.list=this.$rendered.children().map(function(){return b._createItemFromDom(this)}).get())},_createItemFromDom:function(a){var b=this.options.mapDom(a);return this._addItemData(b,a),b},_fire:function(b,c){var b=a.Event(b);a(this).triggerHandler(b,c),a(this.playlists).triggerHandler(b,a.merge([{list:this}],c||[])),this.$rendered&&this.$rendered.triggerHandler(b,c)},_addDomList:function(){this.$rendered.attr({"data-autoplay":this.options.autoplay,"data-loop":this.options.loop}).addClass("media-playlist").data("playlist",this)},_addItemData:function(b,c){var d=this;b.$item=a(c).data("itemData",b),this.options.addItemEvents&&b.$item.on("click.playlist",function(a){return d.options.addItemEvents?(d.playItem(b,a),!1):void 0})},_addEvents:function(a){var b=a.options,c=function(c){b.autoplay&&a.playNext(c)};this.media.on("ended",c),this._remove=function(){a.media.off("ended",c),a.autoplay(!1),a.$rendered&&a.$rendered.remove(),a._fire("removelist")}},_remove:function(){this._fire("removelist")},render:function(b){this.$rendered?b(this.$rendered,this.player,this):this.deferred.done(function(){var c,d=this,e=[];if(!this.$rendered){switch(a.each(this.list,function(b,c){var f=a(a.parseHTML(d.options.renderer(c,d.options.itemTmpl))).filter(g)[0];d._addItemData(c,f),e.push(f)}),c=(e[0]&&e[0].nodeName||"").toLowerCase()){case"li":this.$rendered=a.parseHTML("<ul />");break;case"option":this.$rendered=a.parseHTML("<select />");break;default:this.$rendered=a.parseHTML("<div />")}this.$rendered=a(this.$rendered).html(e),this._addDomList()}b(this.$rendered,this.player,this)})},_loadItem:function(b){var c=this.media;c.attr("poster",b.poster||""),a("track",c).remove(),a.each(b.tracks||[],function(b,d){a("<track />").attr(d).appendTo(c)}),c.jmeProp("srces",b.srces)},_getItem:function(b){return b&&(b.nodeName||b.jquery||"string"==typeof b)&&(b=a(b).data("itemData")),b},playItem:function(a,b){this.selectedItem(a,b),a&&this.media.play()},selectedIndex:function(a,b){return arguments.length?(this.selectedItem(this.list[a],b),void 0):this._selectedIndex},selectedItem:function(b,c){var d,e;return arguments.length?(e=-1,b=this._getItem(b),b&&a.each(this.list,function(a){return b==this?(e=a,!1):void 0}),e>=0&&this._loadItem(this.list[e]),e!=this._selectedIndex&&(d=this._selectedItem||null,d&&d.$item&&d.$item.removeClass("selected-item"),this._selectedItem=this.list[e]||null,this._selectedIndex=e,this._selectedItem&&this._selectedItem.$item&&this._selectedItem.$item.addClass("selected-item"),d!==this._selectedItem&&this._fire("itemchange",[{oldItem:d,from:c||null}])),void 0):this._selectedItem},playNext:function(){var a=this.getNext();a&&this.playItem(a)},playPrev:function(){var a=this.getPrev();a&&this.playItem(a)},getNext:function(){var a=this._selectedIndex+1;return this.list[a]||(this.options.loop?this.list[0]:null)},getPrev:function(){var a=this._selectedIndex-1;return this.list[a]||(this.options.loop?this.list[this.list.length-1]:null)}}),[{name:"autoplay",fn:"getAutoplayList"},{name:"showcontrols",fn:"getShowcontrolsList"},{name:"loop"}].forEach(function(a){c.prototype[a.name]=function(b){var c;return arguments.length?(b=!!b,b&&a.fn&&(c=this.playlists[a.fn](),c&&c!=this&&c[a.name](!1)),this.options[a.name]!=b&&(this.options[a.name]=b,this.$rendered&&this.$rendered.attr("data-"+a.name,b),this._fire(a.name+"change")),void 0):this.options[a.name]}}),h.defineProp("playlists",{writable:!1,get:function(c){var d=a.jme.data(c);return c!=d.player[0]?null:(d.playlists||(d.playlists=new b(d)),d.playlists)}}),h.defineMethod("addPlaylist",function(b,c){var d=a.jme.prop(this,"playlists");return d&&d.add?d.add(b,c):null}),[{name:"playlist-prev",text:"previous",get:"getPrev",play:"playPrev"},{name:"playlist-next",text:"next",get:"getNext",play:"playNext"}].forEach(function(b){a.jme.registerPlugin(b.name,{structure:j,text:b.text,_create:function(a,c,d){function e(){var c=g[b.get]();c?a.prop({disabled:!1,title:c.title}):a.prop({disabled:!0,title:""})}function f(){var a=h.getShowcontrolsList();a!=g&&(g&&g.off("itemchange",e),g=a,g&&(g.on("itemchange",e),e()))}var g,h=d.jmeProp("playlists");a.on("click",function(){g&&g[b.play]()}),h.on({"addlist removelist showcontrolschange":f}),f()}})}),function(){var b={};a.jme.tmpl=function(a,c){return b[a]||(b[a]=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');")),c?b[a](c):b[a]}}(),a.jme.Playlist=c});