!function(a){if(webshims.support.texttrackapi&&document.addEventListener){var b=webshims.cfg.track,c=function(b){a(b.target).filter("track").each(e)},d=webshims.bugs.track,e=function(){return d||!b.override&&3==a.prop(this,"readyState")?(b.override=!0,webshims.reTest("track"),document.removeEventListener("error",c,!0),this&&a.nodeName(this,"track")?webshims.error("track support was overwritten. Please check your vtt including your vtt mime-type"):webshims.info("track support was overwritten. due to bad browser support"),!1):void 0},f=function(){document.addEventListener("error",c,!0),d?e():a("track").each(e),d||b.override||webshims.defineProperty(TextTrack.prototype,"shimActiveCues",{get:function(){return this._shimActiveCues||this.activeCues}})};b.override||a(f)}}(webshims.$),webshims.register("track-ui",function(a,b,c,d,e){"use strict";function f(a,b){var c=!0,d=0,e=a.length;if(e!=b.length)c=!1;else for(;e>d;d++)if(a[d]!=b[d]){c=!1;break}return c}var g=b.cfg.track,h=b.support,i={subtitles:1,captions:1,descriptions:1},j=b.mediaelement,k=function(){return!g.override&&h.texttrackapi},l=c.cancelAnimationFrame&&c.requestAnimationFrame||function(a){setTimeout(a,17)},m=c.cancelAnimationFrame||c.clearTimeout,n={update:function(c,d){c.activeCues.length?f(c.displayedActiveCues,c.activeCues)||(c.displayedActiveCues=c.activeCues,c.trackDisplay||(c.trackDisplay=a('<div class="cue-display '+b.shadowClass+'"><span class="description-cues" aria-live="assertive" /></div>').insertAfter(d),this.addEvents(c,d),b.docObserve()),c.hasDirtyTrackDisplay&&d.triggerHandler("forceupdatetrackdisplay"),this.showCues(c)):this.hide(c)},showCues:function(b){var c=a('<span class="cue-wrapper" />');a.each(b.displayedActiveCues,function(d,e){var f=e.id?'id="cue-id-'+e.id+'"':"",g=a('<span class="cue-line"><span '+f+' class="cue" /></span>').find("span").html(e.getCueAsHTML()).end();"descriptions"==e.track.kind?setTimeout(function(){a("span.description-cues",b.trackDisplay).html(g)},0):c.prepend(g)}),a("span.cue-wrapper",b.trackDisplay).remove(),b.trackDisplay.append(c)},addEvents:function(a,b){if(g.positionDisplay){var c,d=function(c){if(a.displayedActiveCues.length||c===!0){a.trackDisplay.css({display:"none"});var d=b.getShadowElement(),e=d.innerHeight(),f=d.innerWidth(),g=d.position();a.trackDisplay.css({left:g.left,width:f,height:e-45,top:g.top,display:"block"}),a.trackDisplay.css("fontSize",Math.max(Math.round(e/30),7)),a.hasDirtyTrackDisplay=!1}else a.hasDirtyTrackDisplay=!0},e=function(){clearTimeout(c),c=setTimeout(d,0)},f=function(){d(!0)};b.on("playerdimensionchange mediaelementapichange updatetrackdisplay updatemediaelementdimensions swfstageresize",e),b.on("forceupdatetrackdisplay",f).onWSOff("updateshadowdom",e),f()}},hide:function(b){b.trackDisplay&&b.displayedActiveCues.length&&(b.displayedActiveCues=[],a("span.cue-wrapper",b.trackDisplay).remove(),a("span.description-cues",b.trackDisplay).empty())}};if(j.trackDisplay=n,!j.createCueList){var o={getCueById:function(a){for(var b=null,c=0,d=this.length;d>c;c++)if(this[c].id===a){b=this[c];break}return b}};j.createCueList=function(){return a.extend([],o)}}j.getActiveCue=function(b,c,d,e){b._lastFoundCue||(b._lastFoundCue={index:0,time:0}),b._shimActiveCues||!h.texttrackapi||g.override||(b._shimActiveCues=j.createCueList());for(var f,k,l,m=0;m<b.shimActiveCues.length;m++)k=b.shimActiveCues[m],k.startTime>d||k.endTime<d?(b.shimActiveCues.splice(m,1),m--,k.pauseOnExit&&a(c).pause(),a(b).triggerHandler("cuechange"),a(k).triggerHandler("exit")):(l=k.endTime-d,e.nextUpdateDelay>l&&(e.nextUpdateDelay=l,e.nextEvent=k.endTime),"showing"==b.mode&&i[b.kind]&&-1==a.inArray(k,e.activeCues)&&e.activeCues.push(k));for(f=b.cues.length,m=b._lastFoundCue.time<d?b._lastFoundCue.index:0;f>m;m++)if(k=b.cues[m],k.startTime<=d&&k.endTime>=d&&-1==a.inArray(k,b.shimActiveCues)&&(b.shimActiveCues.push(k),"showing"==b.mode&&i[b.kind]&&e.activeCues.push(k),a(b).triggerHandler("cuechange"),a(k).triggerHandler("enter"),b._lastFoundCue.time=d,b._lastFoundCue.index=m,l=k.endTime-d,e.nextUpdateDelay>l&&(e.nextUpdateDelay=l,e.nextEvent=k.endTime)),k.startTime>d){l=k.startTime-d,e.nextUpdateDelay>l&&(e.nextUpdateDelay=l,e.nextEvent=k.startTime);break}};var p=function(){return b.implement(this,"trackui")},q=function(){var c,d,f,g,h,i,o,p=.27,q=a(this),r=0,s=function(){r++,30>r?q.prop("currentTime")>c.nextEvent?(r=e,t()):o=l(s):r=e},t=function(a){var e,k;if(d&&c||(d=q.prop("textTracks"),c=b.data(q[0],"mediaelementBase")||b.data(q[0],"mediaelementBase",{}),c.displayedActiveCues||(c.displayedActiveCues=[])),d&&(k=q.prop("currentTime"),!(!k&&0!==k||c.nextEvent&&a&&"timeupdate"==a.type&&k>=i&&c.nextEvent-k>p&&9>k-i))){i=k,h=c.nextUpdateDelay,c.nextUpdateDelay=Number.MAX_VALUE,c.activeCues=[];for(var l=0,t=d.length;t>l;l++)e=d[l],"disabled"!=e.mode&&e.cues&&e.cues.length&&j.getActiveCue(e,q,k,c);n.update(c,q),clearTimeout(f),c.nextUpdateDelay<=p&&(a||h!=c.nextUpdateDelay)&&c.nextUpdateDelay>0?(h=c.nextUpdateDelay,clearTimeout(g),o&&m(o),r=0,g=setTimeout(s,Math.max(1e3*c.nextUpdateDelay-100,0))):c.nextUpdateDelay>=Number.MAX_VALUE&&(c.nextEvent=Number.MAX_VALUE)}},u=function(){clearTimeout(f),f=setTimeout(t,17)},v=function(){d||(d=q.prop("textTracks")),a([d]).on("change",u),q.off(".trackview").on("play.trackview playing.trackview updatetrackdisplay.trackview seeked.trackview",u).on("timeupdate.trackview",t)};q.on("remove",function(a){!a.originalEvent&&c&&c.trackDisplay&&setTimeout(function(){c.trackDisplay.remove()},4)}),k()?(q.hasClass("nonnative-api-active")&&v(),q.on("mediaelementapichange trackapichange",function(){!k()||q.hasClass("nonnative-api-active")?v():(clearTimeout(f),clearTimeout(g),o&&m(o),d=q.prop("textTracks"),c=b.data(q[0],"mediaelementBase")||b.data(q[0],"mediaelementBase",{}),a.each(d,function(a,b){b._shimActiveCues&&delete b._shimActiveCues}),n.hide(c),q.off(".trackview"))})):v()};k()&&(!function(){var c,d=function(b){c=!0,setTimeout(function(){a(b).triggerHandler("updatetrackdisplay"),c=!1},9)},e=function(e,f,g){var h,i="_sup"+g,j={prop:{}};j.prop[g]=function(){return!c&&k()&&d(a(this).closest("audio, video")),h.prop[i].apply(this,arguments)},h=b.defineNodeNameProperty(e,f,j)};e("track","track","get"),["audio","video"].forEach(function(a){e(a,"textTracks","get"),e("nodeName","addTextTrack","value")})}(),a.propHooks.activeCues={get:function(a){return a._shimActiveCues||a.activeCues}}),b.addReady(function(b,c){a("video, audio",b).add(c.filter("video, audio")).filter(p).each(q)})});