!function(a){if(webshims.support.texttrackapi&&document.addEventListener){var b=webshims.cfg.track,c=function(b){a(b.target).filter("track").each(e)},d=webshims.bugs.track,e=function(){return d||!b.override&&3==a.prop(this,"readyState")?(b.override=!0,webshims.reTest("track"),document.removeEventListener("error",c,!0),this&&a.nodeName(this,"track")?webshims.error("track support was overwritten. Please check your vtt including your vtt mime-type"):webshims.info("track support was overwritten. due to bad browser support"),!1):void 0},f=function(){document.addEventListener("error",c,!0),d?e():a("track").each(e),d||b.override||webshims.defineProperty(TextTrack.prototype,"shimActiveCues",{get:function(){return this._shimActiveCues||this.activeCues}})};b.override||a(f)}}(webshims.$),webshims.register("track-ui",function(a,b){"use strict";function c(a,b){var c=!0,d=0,e=a.length;if(e!=b.length)c=!1;else for(;e>d;d++)if(a[d]!=b[d]){c=!1;break}return c}var d=b.cfg.track,e=b.support,f={subtitles:1,captions:1,descriptions:1},g=b.mediaelement,h=function(){return!d.override&&e.texttrackapi},i={update:function(d,e){d.activeCues.length?c(d.displayedActiveCues,d.activeCues)||(d.displayedActiveCues=d.activeCues,d.trackDisplay||(d.trackDisplay=a('<div class="cue-display '+b.shadowClass+'"><span class="description-cues" aria-live="assertive" /></div>').insertAfter(e),this.addEvents(d,e),b.docObserve()),d.hasDirtyTrackDisplay&&e.triggerHandler("forceupdatetrackdisplay"),this.showCues(d)):this.hide(d)},showCues:function(b){var c=a('<span class="cue-wrapper" />');a.each(b.displayedActiveCues,function(d,e){var f=e.id?'id="cue-id-'+e.id+'"':"",g=a('<span class="cue-line"><span '+f+' class="cue" /></span>').find("span").html(e.getCueAsHTML()).end();"descriptions"==e.track.kind?setTimeout(function(){a("span.description-cues",b.trackDisplay).html(g)},0):c.prepend(g)}),a("span.cue-wrapper",b.trackDisplay).remove(),b.trackDisplay.append(c)},addEvents:function(a,b){if(d.positionDisplay){var c,e=function(c){if(a.displayedActiveCues.length||c===!0){a.trackDisplay.css({display:"none"});var d=b.getShadowElement(),e=d.innerHeight(),f=d.innerWidth(),g=d.position();a.trackDisplay.css({left:g.left,width:f,height:e-45,top:g.top,display:"block"}),a.trackDisplay.css("fontSize",Math.max(Math.round(e/30),7)),a.hasDirtyTrackDisplay=!1}else a.hasDirtyTrackDisplay=!0},f=function(){clearTimeout(c),c=setTimeout(e,0)},g=function(){e(!0)};b.on("playerdimensionchange mediaelementapichange updatetrackdisplay updatemediaelementdimensions swfstageresize",f),b.on("forceupdatetrackdisplay",g).onWSOff("updateshadowdom",f),g()}},hide:function(b){b.trackDisplay&&b.displayedActiveCues.length&&(b.displayedActiveCues=[],a("span.cue-wrapper",b.trackDisplay).remove(),a("span.description-cues",b.trackDisplay).empty())}};if(g.trackDisplay=i,!g.createCueList){var j={getCueById:function(a){for(var b=null,c=0,d=this.length;d>c;c++)if(this[c].id===a){b=this[c];break}return b}};g.createCueList=function(){return a.extend([],j)}}g.getActiveCue=function(b,c,h,i){b._lastFoundCue||(b._lastFoundCue={index:0,time:0}),b._shimActiveCues||!e.texttrackapi||d.override||(b._shimActiveCues=g.createCueList());for(var j,k,l,m=0;m<b.shimActiveCues.length;m++)k=b.shimActiveCues[m],k.startTime>h||k.endTime<h?(b.shimActiveCues.splice(m,1),m--,k.pauseOnExit&&a(c).pause(),a(b).triggerHandler("cuechange"),a(k).triggerHandler("exit")):(l=k.endTime-h,i.nextUpdateDelay>l&&(i.nextUpdateDelay=l),"showing"==b.mode&&f[b.kind]&&-1==a.inArray(k,i.activeCues)&&i.activeCues.push(k));for(j=b.cues.length,m=b._lastFoundCue.time<h?b._lastFoundCue.index:0;j>m;m++)if(k=b.cues[m],k.startTime<=h&&k.endTime>=h&&-1==a.inArray(k,b.shimActiveCues)&&(b.shimActiveCues.push(k),"showing"==b.mode&&f[b.kind]&&i.activeCues.push(k),a(b).triggerHandler("cuechange"),a(k).triggerHandler("enter"),b._lastFoundCue.time=h,b._lastFoundCue.index=m),k.startTime>h){l=k.startTime-h,i.nextUpdateDelay>l&&(i.nextUpdateDelay=l);break}};var k=function(){return b.implement(this,"trackui")},l=function(){var c,d,e,f,j=a(this),k=function(a){var h,l;if(d&&c||(d=j.prop("textTracks"),c=b.data(j[0],"mediaelementBase")||b.data(j[0],"mediaelementBase",{}),c.displayedActiveCues||(c.displayedActiveCues=[])),d&&(l=j.prop("currentTime"),l||0===l)){f=c.nextUpdateDelay,c.nextUpdateDelay=.3,c.activeCues=[];for(var m=0,n=d.length;n>m;m++)h=d[m],"disabled"!=h.mode&&h.cues&&h.cues.length&&g.getActiveCue(h,j,l,c);i.update(c,j),c.nextUpdateDelay<.3&&(a||f!=c.nextUpdateDelay)&&(f=c.nextUpdateDelay,e=setTimeout(k,Math.ceil(1e3*c.nextUpdateDelay+40)))}},l=function(){d||(d=j.prop("textTracks")),a([d]).on("change",k),j.off(".trackview").on("play.trackview timeupdate.trackview updatetrackdisplay.trackview",k)};j.on("remove",function(a){!a.originalEvent&&c&&c.trackDisplay&&setTimeout(function(){c.trackDisplay.remove()},4)}),h()?(j.hasClass("nonnative-api-active")&&l(),j.on("mediaelementapichange trackapichange",function(){!h()||j.hasClass("nonnative-api-active")?l():(clearTimeout(e),d=j.prop("textTracks"),c=b.data(j[0],"mediaelementBase")||b.data(j[0],"mediaelementBase",{}),a.each(d,function(a,b){b._shimActiveCues&&delete b._shimActiveCues}),i.hide(c),j.off(".trackview"))})):l()};h()&&(!function(){var c,d=function(b){c=!0,setTimeout(function(){a(b).triggerHandler("updatetrackdisplay"),c=!1},9)},e=function(e,f,g){var i,j="_sup"+g,k={prop:{}};k.prop[g]=function(){return!c&&h()&&d(a(this).closest("audio, video")),i.prop[j].apply(this,arguments)},i=b.defineNodeNameProperty(e,f,k)};e("track","track","get"),["audio","video"].forEach(function(a){e(a,"textTracks","get"),e("nodeName","addTextTrack","value")})}(),a.propHooks.activeCues={get:function(a){return a._shimActiveCues||a.activeCues}}),b.addReady(function(b,c){a("video, audio",b).add(c.filter("video, audio")).filter(k).each(l)})});