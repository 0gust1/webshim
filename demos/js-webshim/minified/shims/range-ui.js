(function(e){var t=0,n=function(e){return typeof e=="number"||e&&e==e*1},r=function(e,t){return typeof e=="number"||e&&e==e*1?e*1:t},i=["step","min","max","readonly","title","disabled","tabindex"],s={_create:function(){var t;this.element.addClass("ws-range").attr({role:"slider"}).html('<span class="ws-range-min" /><span class="ws-range-rail"><span class="ws-range-thumb" /></span>'),this.trail=e(".ws-range-rail",this.element),this.range=e(".ws-range-min",this.element),this.thumb=e(".ws-range-thumb",this.trail),this.updateMetrics(),this.orig=this.options.orig;for(t=0;t<i.length;t++)this[i[t]](this.options[i[t]]);this.value=this._value,this.value(this.options.value),this.list(this.options.options),this.element.data("rangeUi",this),this.addBindings(),this._init=!0},value:e.noop,_value:function(e,t,n){var r,i=this.options,s=e,o={},u={};!t&&parseFloat(e,10)!=e&&(e=i.min+(i.max-i.min)/2),t||(e=this.normalizeVal(e)),r=100*((e-i.min)/(i.max-i.min)),this.options.value=e,this.thumb.stop(),this.range.stop(),u[this.dirs.width]=r+"%",this.vertical&&(r=Math.abs(r-100)),o[this.dirs.left]=r+"%",n?(typeof i.animate!="object"&&(i.animate={}),this.thumb.animate(o,i.animate),this.range.animate(u,i.animate)):(this.thumb.css(o),this.range.css(u)),this.orig&&(s!=e||!this._init&&this.orig.value!=e)&&this.options._change(e),this.element.attr({"aria-valuenow":this.options.value,"aria-valuetext":this.options.options[this.options.value]||this.options.value})},list:function(t){var r=this.options,i=r.min,s=r.max,o=this.trail,u=this;r.options=t||{},this.element.attr({"aria-valuetext":r.options[r.value]||r.value}),e(".ws-range-ticks",o).remove(),e.each(r.options,function(e,t){if(!n(e)||e<i||e>s)return;var a=100*((e-i)/(s-i)),f=r.showLabels?' title="'+t+'"':"";o.append('<span class="ws-range-ticks"'+f+' style="'+u.dirs.pos+": "+a+'%;" />')})},readonly:function(e){e=!!e,this.options.readonly=e,this.element.attr("aria-readonly",""+e)},disabled:function(e){e=!!e,this.options.disabled=e,e?this.element.attr({tabindex:-1,"aria-disbaled":"true"}):this.element.attr({tabindex:this.options.tabindex,"aria-disbaled":"false"})},tabindex:function(e){this.options.tabindex=e,this.options.disabled||this.element.attr({tabindex:e})},title:function(e){this.element.prop("title",e)},min:function(e){this.options.min=r(e,0),this.value(this.options.value,!0)},max:function(e){this.options.max=r(e,100),this.value(this.options.value,!0)},step:function(e){this.options.step=e=="any"?"any":r(e,1),this.value(this.options.value)},normalizeVal:function(e){var t,n,r,i=this.options;return e<=i.min?e=i.min:e>=i.max?e=i.max:i.step!="any"&&(r=i.step,t=(e-i.min)%r,n=e-t,Math.abs(t)*2>=r&&(n+=t>0?r:-r),e=n.toFixed(5)*1),e},doStep:function(e){var t=r(this.options.step,1);this.options.step=="any"&&(t=Math.min(t,(this.options.max-this.options.min)/10)),this.value(this.options.value+t*e)},getStepedValueFromPos:function(e){var t,n,r,i;return e<=0?t=this.options[this.dirs.min]:e>100?t=this.options[this.dirs.max]:(this.vertical&&(e=Math.abs(e-100)),t=(this.options.max-this.options.min)*(e/100)+this.options.min,i=this.options.step,i!="any"&&(n=(t-this.options.min)%i,r=t-n,Math.abs(n)*2>=i&&(r+=n>0?i:-i),t=r.toFixed(5)*1)),t},addBindings:function(){var t,n,r,i=this,s=this.options,o=function(){var t={};return{init:function(n,r,s){t[n]||(t[n]={fn:s},i.orig&&e(i.orig).on(n,function(){t[n].val=e.prop(i.orig,"value")})),t[n].val=r},call:function(e,n){t[e].val!=n&&(clearTimeout(t[e].timer),t[e].val=n,t[e].timer=setTimeout(function(){t[e].fn(n,i)},0))}}}(),u=function(e,r){this.vertical&&(left=Math.abs(left-100));var u=i.getStepedValueFromPos((e[i.dirs.mouse]-t)*n);u!=s.value&&(i.value(u,!1,r),o.call("input",u))},a=function(t){t&&t.type=="mouseup"&&(o.call("input",s.value),o.call("change",s.value)),i.element.removeClass("ws-active"),e(document).off("mousemove",u).off("mouseup",a)},f=function(r){r.preventDefault(),e(document).off("mousemove",u).off("mouseup",a);if(!s.readonly&&!s.disabled){t=i.element.focus().addClass("ws-active").offset(),n=i.element[i.dirs.width]();if(!n||!t)return;t=t[i.dirs.pos],n=100/(n-(i.thumb[i.dirs.outerWidth]()||2)/2),u(r,i.options.animate),e(document).on({mouseup:a,mousemove:u}),r.stopPropagation()}};o.init("input",s.value,this.options.input),o.init("change",s.value,this.options.change),this.element.on({mousedown:f,focus:function(e){s.disabled||(o.init("input",s.value),o.init("change",s.value),i.element.addClass("ws-focus")),r=!0},blur:function(e){i.element.removeClass("ws-focus ws-active"),r=!1,o.init("input",s.value),o.call("change",s.value)},keyup:function(){i.element.removeClass("ws-active"),o.call("input",s.value),o.call("change",s.value)},mousewheel:function(e,t){t&&r&&!s.readonly&&!s.disabled&&(i.doStep(t),e.preventDefault(),o.call("input",s.value))},keypress:function(e){var t=!0,n=e.keyCode;!s.readonly&&!s.disabled&&(n==39||n==38?i.doStep(1):n==37||n==40?i.doStep(-1):n==33?i.doStep(10):n==34?i.doStep(-10):n==36?i.value(i.options.max):n==35?i.value(i.options.min):t=!1,t&&(i.element.addClass("ws-active"),o.call("input",s.value),e.preventDefault()))}}),this.thumb.on({mousedown:f})},updateMetrics:function(){this.vertical=this.element.innerHeight()-this.element.innerWidth()>10,this.dirs=this.vertical?{mouse:"pageY",pos:"top",min:"max",max:"min",left:"top",width:"height",outerWidth:"outerHeight"}:{mouse:"pageX",pos:"left",min:"min",max:"min",left:"left",width:"width",outerWidth:"outerWidth"},this.element[this.vertical?"addClass":"removeClass"]("vertical-range")[this.vertical?"addClass":"removeClass"]("horizontal-range")}};e.fn.rangeUI=function(t){return t=e.extend({readonly:!1,disabled:!1,tabindex:0,min:0,step:1,max:100,value:50,input:e.noop,change:e.noop,_change:e.noop,showLabels:!0},t),this.each(function(){e.webshims.objectCreate(s,{element:{value:e(this)}},t)})},jQuery.webshims.isReady("range-ui",!0)})(jQuery);