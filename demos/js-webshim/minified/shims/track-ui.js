jQuery.webshims.register("track-ui",function(e,d,m){var n=d.cfg.track,l={subtitles:1,captions:1},k={show:function(a,b,c){if(!b.trackDisplay)b.trackDisplay=e('<div class="cue-display"></div>').insertAfter(c),b.hasVisibleTrack=0,this.addEvents(b,c);!b.currentTrack||a.track==b.currentTrack?(b.hasVisibleTrack++,b.currentTrack=a.track,b.visibleCue=a,b.hasDirtyTrackDisplay&&c.triggerHandler("forceupdatetrackdisplay"),b.trackDisplay.html('<span class="cue-text"><span>'+a.text+"</span></span>")):d.warn("we only handle one visible track")},
addEvents:function(a,b){if(n.positionDisplay){var c,h=function(h){if(a.hasVisibleTrack||!0===h){a.trackDisplay.css({display:"none"});var c=b.getShadowElement();c.offsetParent();var h=c.innerHeight(),d=c.innerWidth(),c=c.position(),f=h*d;a.trackDisplay.css({left:c.left,width:d,height:h-5,top:c.top,display:"block"});8E4>f?f="xs":8E4<=f&&1E5>f?f="s":1E5<=f&&3E5>f?f="m":3E5<=f&&55E4>f?f="l":55E4<=f&&99E4>f?f="xl":99E4<=f&&(f="xxl");a.trackDisplay.attr("data-displaysize",f);a.hasDirtyTrackDisplay=!1}else a.hasDirtyTrackDisplay=
!0},j=function(a){clearTimeout(c);c=setTimeout(h,a&&"resize"==a.type?99:9)},d=function(){h(!0)};b.bind("playerdimensionchange mediaelementapichange updatetrackdisplay updatemediaelementdimensions swfstageresize",j);e(m).bind("resize emchange",j);b.bind("forceupdatetrackdisplay",d);d()}},hide:function(a,b){if(b.trackDisplay&&a==b.currentTrack)b.hasVisibleTrack--,b.currentTrack=!1,b.visibleCue=!1,b.trackDisplay.empty()}};d.mediaelement.trackDisplay=k;d.mediaelement.getActiveCue=function(a,b,c,h){if(!a._lastFoundCue)a._lastFoundCue=
{index:0,time:0};if(Modernizr.track&&!a._shimActiveCues)a._shimActiveCues=[];var d=a.cues.length,i=a._lastFoundCue.time<c?a._lastFoundCue.index:0,g;a.shimActiveCues.length&&(a.shimActiveCues[0].startTime>c||a.shimActiveCues[0].endTime<c?(g=a.shimActiveCues[0],a.shimActiveCues.pop(),k.hide(a,h),g.pauseOnExit&&e(b).pause(),e(a).triggerHandler("cuechange"),e(g).triggerHandler("exit")):h.visibleCue!=a.shimActiveCues[0]&&1<a.mode&&l[a.kind]&&k.show(a.shimActiveCues[0],h,b));if(!a.shimActiveCues.length)for(;i<
d;i++){g=a.cues[i];if(g.startTime<=c&&g.endTime>=c){a.shimActiveCues.push(g);1<a.mode&&l[a.kind]&&k.show(g,h,b);e(a).triggerHandler("cuechange");e(g).triggerHandler("enter");a._lastFoundCue.time=c;a._lastFoundCue.index=i;break}if(g.startTime>c)break}};Modernizr.track&&function(){var a,b=function(c){a||setTimeout(function(){a=!0;e(c).triggerHandler("updatetrackdisplay");a=!1},9)},c=d.defineNodeNameProperty("track","track",{prop:{get:function(){b(e(this).parent("audio, video"));return c.prop._supget.apply(this,
arguments)}}});["audio","video"].forEach(function(a){var c,e;e=d.defineNodeNameProperty(a,"textTracks",{prop:{get:function(){b(this);return e.prop._supget.apply(this,arguments)}}});c=d.defineNodeNameProperty(a,"addTextTrack",{prop:{value:function(){b(this);return c.prop._supvalue.apply(this,arguments)}}})})}();d.addReady(function(a,b){e("video, audio",a).add(b.filter("video, audio")).each(function(){var a,b=e(this),j,i=function(){b.unbind(".trackview").bind("play.trackview timeupdate.trackview updatetrackdisplay.trackview",
function(){var g,e;if(!a||!j)a=b.prop("textTracks"),j=d.data(b[0],"mediaelementBase")||d.data(b[0],"mediaelementBase",{});if(a&&((e=b.prop("currentTime"))||0===e))for(var i=0,f=a.length;i<f;i++)g=a[i],0<g.mode&&g.cues&&g.cues.length?d.mediaelement.getActiveCue(g,b,e,j):k.hide(g,j)})};(!Modernizr.track||b.is(".nonnative-api-active"))&&i();Modernizr.track&&b.bind("mediaelementapichange",function(){if(b.is(".nonnative-api-active"))i();else{if(!a||!j)a=b.prop("textTracks"),j=d.data(b[0],"mediaelementBase")||
d.data(b[0],"mediaelementBase",{});e.each(a,function(a,b){k.hide(b,j);b._shimActiveCues&&delete b._shimActiveCues});b.unbind(".trackview")}})})})});
