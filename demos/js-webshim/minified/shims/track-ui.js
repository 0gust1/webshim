jQuery.webshims.register("track-ui",function(f,h,l){var i=h.cfg.track,k={subtitles:1,captions:1},j={update:function(a,d){if(a.activeCues.length){if(!this.compareArray(a.displayedActiveCues,a.activeCues)){a.displayedActiveCues=a.activeCues;if(!a.trackDisplay)a.trackDisplay=f('<div class="cue-display"></div>').insertAfter(d),this.addEvents(a,d);a.hasDirtyTrackDisplay&&d.triggerHandler("forceupdatetrackdisplay");this.showCues(a)}}else this.hide(a)},showCues:function(a){var d=f('<span class="cue-wrapper" />');
f.each(a.displayedActiveCues,function(a,c){d.append(f('<span class="cue" />').html(c.getCueAsHTML()))});a.trackDisplay.html(d)},compareArray:function(a,d){var g=!0,c=0,b=a.length;if(b!=d.length)g=!1;else for(;c<b;c++)if(a[c]!=d[c]){g=!1;break}return g},addEvents:function(a,d){if(i.positionDisplay){var g,c=function(c){if(a.displayedActiveCues.length||!0===c){a.trackDisplay.css({display:"none"});var b=d.getShadowElement();b.offsetParent();var c=b.innerHeight(),g=b.innerWidth(),b=b.position();a.trackDisplay.css({left:b.left,
width:g,height:c-45,top:b.top,display:"block"});a.trackDisplay.css("fontSize",Math.max(Math.round(c/30),7));a.hasDirtyTrackDisplay=!1}else a.hasDirtyTrackDisplay=!0},b=function(a){clearTimeout(g);g=setTimeout(c,a&&"resize"==a.type?99:9)},e=function(){c(!0)};d.bind("playerdimensionchange mediaelementapichange updatetrackdisplay updatemediaelementdimensions swfstageresize",b);f(l).bind("resize emchange",b);d.bind("forceupdatetrackdisplay",e);e()}},hide:function(a){if(a.trackDisplay&&a.displayedActiveCues.length)a.displayedActiveCues=
[],a.trackDisplay.empty()}};h.mediaelement.trackDisplay=j;h.mediaelement.getActiveCue=function(a,d,g,c){if(!a._lastFoundCue)a._lastFoundCue={index:0,time:0};if(Modernizr.track&&!a._shimActiveCues)a._shimActiveCues=[];for(var b=0,e;b<a.shimActiveCues.length;b++)e=a.shimActiveCues[b],e.startTime>g||e.endTime<g?(a.shimActiveCues.splice(b,1),b--,e.pauseOnExit&&f(d).pause(),f(a).triggerHandler("cuechange"),f(e).triggerHandler("exit")):1<a.mode&&k[a.kind]&&-1==f.inArray(e,c.activeCues)&&c.activeCues.push(e);
d=a.cues.length;for(b=a._lastFoundCue.time<g?a._lastFoundCue.index:0;b<d;b++){e=a.cues[b];if(e.startTime<=g&&e.endTime>=g&&-1==f.inArray(e,a.shimActiveCues))a.shimActiveCues.push(e),1<a.mode&&k[a.kind]&&c.activeCues.push(e),f(a).triggerHandler("cuechange"),f(e).triggerHandler("enter"),a._lastFoundCue.time=g,a._lastFoundCue.index=b;if(e.startTime>g)break}};!i.override&&Modernizr.track&&function(){var a,d=function(c){a||setTimeout(function(){a=!0;f(c).triggerHandler("updatetrackdisplay");a=!1},9)},
g=h.defineNodeNameProperty("track","track",{prop:{get:function(){d(f(this).parent("audio, video"));return g.prop._supget.apply(this,arguments)}}});["audio","video"].forEach(function(a){var b,g;g=h.defineNodeNameProperty(a,"textTracks",{prop:{get:function(){d(this);return g.prop._supget.apply(this,arguments)}}});b=h.defineNodeNameProperty(a,"addTextTrack",{prop:{value:function(){d(this);return b.prop._supvalue.apply(this,arguments)}}})})}();h.addReady(function(a,d){f("video",a).add(d.filter("video")).each(function(){var a,
c=f(this),b,d=function(){c.unbind(".trackview").bind("play.trackview timeupdate.trackview updatetrackdisplay.trackview",function(){var d,e;if(!a||!b)if(a=c.prop("textTracks"),b=h.data(c[0],"mediaelementBase")||h.data(c[0],"mediaelementBase",{}),!b.displayedActiveCues)b.displayedActiveCues=[];if(a&&((e=c.prop("currentTime"))||0===e)){b.activeCues=[];for(var f=0,i=a.length;f<i;f++)d=a[f],0<d.mode&&d.cues&&d.cues.length&&h.mediaelement.getActiveCue(d,c,e,b);j.update(b,c)}})};!i.override&&Modernizr.track?
c.bind("mediaelementapichange trackapichange",function(){b=a=!1;if(i.override||!Modernizr.track||c.is(".nonnative-api-active"))d();else{if(!a||!b)a=c.prop("textTracks"),b=h.data(c[0],"mediaelementBase")||h.data(c[0],"mediaelementBase",{});f.each(a,function(a,c){j.hide(c,b);c._shimActiveCues&&delete c._shimActiveCues});c.unbind(".trackview")}}):d()})})});
