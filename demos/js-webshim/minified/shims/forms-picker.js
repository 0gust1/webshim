(function(e){Math.precision=function(e,t){return void 0===t&&(t=0),Math.round(e*Math.pow(10,t))/Math.pow(10,t)};var t=function(t,i,n){var a=i;i.nodeType&&(a=e.data(i,"wsjPicker")||e.data(i,"wsjPicker",{})),e.extend(!0,a,n)},n=function(t,i){var n,a,r,o=this,s=t.find("img").eq(0),l=0,u=100,p=100,c=0,d=100,h=100,f=0,m=0,v=[],g=function(e){for(var t=0;v.length>t;t++)v[t].call(o,o,e)},y=function(i){var r=t.offset();n={l:0|r.left,t:0|r.top},clearTimeout(a),a=setTimeout(function(){T.call(o,i)},0),e(document).bind("mousemove",b).bind("mouseup",w),i.preventDefault()},b=function(e){return clearTimeout(a),a=setTimeout(function(){T.call(o,e)},0),e.stopPropagation(),e.preventDefault(),!1},w=function(t){return e(document).unbind("mouseup",w).unbind("mousemove",b),t.stopPropagation(),t.preventDefault(),!1},T=function(e){var i=e.pageX-n.l,a=e.pageY-n.t,r=t.w,s=t.h;0>i?i=0:i>r&&(i=r),0>a?a=0:a>s&&(a=s),N.call(o,"xy",{x:i/r*p+l,y:a/s*h+c})},x=function(){var e=0,i=0,n=t.w,a=t.h,o=s.w,l=s.h;clearTimeout(r),r=setTimeout(function(){p>0&&(e=f==u?n:0|f/p*n),h>0&&(i=m==d?a:0|m/h*a),o>=n?e=(n>>1)-(o>>1):e-=o>>1,l>=a?i=(a>>1)-(l>>1):i-=l>>1,s.css({left:e+"px",top:i+"px"})},0)},N=function(e,t,i){var n=void 0!==t;if(!n)switch((void 0===e||null==e)&&(e="xy"),e.toLowerCase()){case"x":return f;case"y":return m;case"xy":default:return{x:f,y:m}}if(null==i||i!=o){var a,r,s=!1;switch(null==e&&(e="xy"),e.toLowerCase()){case"x":a=t&&(t.x&&0|t.x||0|t)||0;break;case"y":r=t&&(t.y&&0|t.y||0|t)||0;break;case"xy":default:a=t&&t.x&&0|t.x||0,r=t&&t.y&&0|t.y||0}null!=a&&(l>a?a=l:a>u&&(a=u),f!=a&&(f=a,s=!0)),null!=r&&(c>r?r=c:r>d&&(r=d),m!=r&&(m=r,s=!0)),s&&g.call(o,i||o)}},E=function(e,t){var i=void 0!==t;if(!i)switch((void 0===e||null==e)&&(e="all"),e.toLowerCase()){case"minx":return l;case"maxx":return u;case"rangex":return{minX:l,maxX:u,rangeX:p};case"miny":return c;case"maxy":return d;case"rangey":return{minY:c,maxY:d,rangeY:h};case"all":default:return{minX:l,maxX:u,rangeX:p,minY:c,maxY:d,rangeY:h}}var n,a,r,o;switch(null==e&&(e="all"),e.toLowerCase()){case"minx":n=t&&(t.minX&&0|t.minX||0|t)||0;break;case"maxx":a=t&&(t.maxX&&0|t.maxX||0|t)||0;break;case"rangex":n=t&&t.minX&&0|t.minX||0,a=t&&t.maxX&&0|t.maxX||0;break;case"miny":r=t&&(t.minY&&0|t.minY||0|t)||0;break;case"maxy":o=t&&(t.maxY&&0|t.maxY||0|t)||0;break;case"rangey":r=t&&t.minY&&0|t.minY||0,o=t&&t.maxY&&0|t.maxY||0;break;case"all":default:n=t&&t.minX&&0|t.minX||0,a=t&&t.maxX&&0|t.maxX||0,r=t&&t.minY&&0|t.minY||0,o=t&&t.maxY&&0|t.maxY||0}null!=n&&l!=n&&(l=n,p=u-l),null!=a&&u!=a&&(u=a,p=u-l),null!=r&&c!=r&&(c=r,h=d-c),null!=o&&d!=o&&(d=o,h=d-c)},k=function(t){e.isFunction(t)&&v.push(t)},A=function(t){if(e.isFunction(t))for(var i;-1!=(i=e.inArray(t,v));)v.splice(i,1)},C=function(){e(document).unbind("mouseup",w).unbind("mousemove",b),t.unbind("mousedown",y),t=null,s=null,v=null};e.extend(!0,o,{val:N,range:E,bind:k,unbind:A,destroy:C}),s.src=i.arrow&&i.arrow.image,s.w=i.arrow&&i.arrow.width||s.width(),s.h=i.arrow&&i.arrow.height||s.height(),t.w=i.map&&i.map.width||t.width(),t.h=i.map&&i.map.height||t.height(),t.bind("mousedown",y),k.call(o,x)},a=function(e,i,n,a){var r=this,o=e.find("td.Text input"),s=o.eq(3),l=o.eq(4),u=o.eq(5),p=o.length>7?o.eq(6):null,c=o.eq(0),d=o.eq(1),h=o.eq(2),f=o.eq(o.length>7?7:6),m=o.length>7?o.eq(8):null,v=function(e){if(""!=e.target.value||e.target==f.get(0)||(null==n||e.target==n.get(0))&&null!=n){if(!b(e))return e;switch(e.target){case s.get(0):switch(e.keyCode){case 38:return s.val(w.call(r,(s.val()<<0)+1,0,255)),i.val("r",s.val(),e.target),!1;case 40:return s.val(w.call(r,(s.val()<<0)-1,0,255)),i.val("r",s.val(),e.target),!1}break;case l.get(0):switch(e.keyCode){case 38:return l.val(w.call(r,(l.val()<<0)+1,0,255)),i.val("g",l.val(),e.target),!1;case 40:return l.val(w.call(r,(l.val()<<0)-1,0,255)),i.val("g",l.val(),e.target),!1}break;case u.get(0):switch(e.keyCode){case 38:return u.val(w.call(r,(u.val()<<0)+1,0,255)),i.val("b",u.val(),e.target),!1;case 40:return u.val(w.call(r,(u.val()<<0)-1,0,255)),i.val("b",u.val(),e.target),!1}break;case p&&p.get(0):switch(e.keyCode){case 38:return p.val(w.call(r,parseFloat(p.val())+1,0,100)),i.val("a",Math.precision(255*p.val()/100,a),e.target),!1;case 40:return p.val(w.call(r,parseFloat(p.val())-1,0,100)),i.val("a",Math.precision(255*p.val()/100,a),e.target),!1}break;case c.get(0):switch(e.keyCode){case 38:return c.val(w.call(r,(c.val()<<0)+1,0,360)),i.val("h",c.val(),e.target),!1;case 40:return c.val(w.call(r,(c.val()<<0)-1,0,360)),i.val("h",c.val(),e.target),!1}break;case d.get(0):switch(e.keyCode){case 38:return d.val(w.call(r,(d.val()<<0)+1,0,100)),i.val("s",d.val(),e.target),!1;case 40:return d.val(w.call(r,(d.val()<<0)-1,0,100)),i.val("s",d.val(),e.target),!1}break;case h.get(0):switch(e.keyCode){case 38:return h.val(w.call(r,(h.val()<<0)+1,0,100)),i.val("v",h.val(),e.target),!1;case 40:return h.val(w.call(r,(h.val()<<0)-1,0,100)),i.val("v",h.val(),e.target),!1}}}},g=function(e){if(""!=e.target.value||e.target==f.get(0)||(null==n||e.target==n.get(0))&&null!=n){if(!b(e))return e;switch(e.target){case s.get(0):s.val(w.call(r,s.val(),0,255)),i.val("r",s.val(),e.target);break;case l.get(0):l.val(w.call(r,l.val(),0,255)),i.val("g",l.val(),e.target);break;case u.get(0):u.val(w.call(r,u.val(),0,255)),i.val("b",u.val(),e.target);break;case p&&p.get(0):p.val(w.call(r,p.val(),0,100)),i.val("a",Math.precision(255*p.val()/100,a),e.target);break;case c.get(0):c.val(w.call(r,c.val(),0,360)),i.val("h",c.val(),e.target);break;case d.get(0):d.val(w.call(r,d.val(),0,100)),i.val("s",d.val(),e.target);break;case h.get(0):h.val(w.call(r,h.val(),0,100)),i.val("v",h.val(),e.target);break;case f.get(0):f.val(f.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),n&&n.val(f.val()),i.val("hex",""!=f.val()?f.val():null,e.target);break;case n&&n.get(0):n.val(n.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),f.val(n.val()),i.val("hex",""!=n.val()?n.val():null,e.target);break;case m&&m.get(0):m.val(m.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2)),i.val("a",null!=m.val()?parseInt(m.val(),16):null,e.target)}}},y=function(e){if(null!=i.val())switch(e.target){case s.get(0):s.val(i.val("r"));break;case l.get(0):l.val(i.val("g"));break;case u.get(0):u.val(i.val("b"));break;case p&&p.get(0):p.val(Math.precision(100*i.val("a")/255,a));break;case c.get(0):c.val(i.val("h"));break;case d.get(0):d.val(i.val("s"));break;case h.get(0):h.val(i.val("v"));break;case f.get(0):case n&&n.get(0):f.val(i.val("hex")),n&&n.val(i.val("hex"));break;case m&&m.get(0):m.val(i.val("ahex").substring(6))}},b=function(e){switch(e.keyCode){case 9:case 16:case 29:case 37:case 39:return!1;case"c".charCodeAt():case"v".charCodeAt():if(e.ctrlKey)return!1}return!0},w=function(e,t,i){return""==e||isNaN(e)?t:e>i?i:t>e?t:e},T=function(e,t){var i=e.val("all");t!=s.get(0)&&s.val(null!=i?i.r:""),t!=l.get(0)&&l.val(null!=i?i.g:""),t!=u.get(0)&&u.val(null!=i?i.b:""),p&&t!=p.get(0)&&p.val(null!=i?Math.precision(100*i.a/255,a):""),t!=c.get(0)&&c.val(null!=i?i.h:""),t!=d.get(0)&&d.val(null!=i?i.s:""),t!=h.get(0)&&h.val(null!=i?i.v:""),t!=f.get(0)&&(n&&t!=n.get(0)||!n)&&f.val(null!=i?i.hex:""),n&&t!=n.get(0)&&t!=f.get(0)&&n.val(null!=i?i.hex:""),m&&t!=m.get(0)&&m.val(null!=i?i.ahex.substring(6):"")},x=function(){s.add(l).add(u).add(p).add(c).add(d).add(h).add(f).add(n).add(m).unbind("keyup",g).unbind("blur",y),s.add(l).add(u).add(p).add(c).add(d).add(h).unbind("keydown",v),i.unbind(T),s=null,l=null,u=null,p=null,c=null,d=null,h=null,f=null,m=null};t(!0,r,{destroy:x}),s.add(l).add(u).add(p).add(c).add(d).add(h).add(f).add(n).add(m).bind("keyup",g).bind("blur",y),s.add(l).add(u).add(p).add(c).add(d).add(h).bind("keydown",v),i.bind(T)};e.wsjPicker={List:[],Color:function(i){var n,a,r,o,l,u,p,c=this,d=[],h=function(e){for(var t=0;d.length>t;t++)d[t].call(c,c,e)},f=function(e,t,i){var d=void 0!==t;if(!d){if((void 0===e||null==e||""==e)&&(e="all"),null==n)return null;switch(e.toLowerCase()){case"ahex":return s.rgbaToHex({r:n,g:a,b:r,a:o});case"hex":return f("ahex").substring(0,6);case"all":return{r:n,g:a,b:r,a:o,h:l,s:u,v:p,hex:f.call(c,"hex"),ahex:f.call(c,"ahex")};default:for(var m={},v=0;e.length>v;v++)switch(e.charAt(v)){case"r":1==e.length?m=n:m.r=n;break;case"g":1==e.length?m=a:m.g=a;break;case"b":1==e.length?m=r:m.b=r;break;case"a":1==e.length?m=o:m.a=o;break;case"h":1==e.length?m=l:m.h=l;break;case"s":1==e.length?m=u:m.s=u;break;case"v":1==e.length?m=p:m.v=p}return m=={}?f.call(c,"all"):m}}if(null==i||i!=c){var g=!1;if(null==e&&(e=""),null==t)return null!=n&&(n=null,g=!0),null!=a&&(a=null,g=!0),null!=r&&(r=null,g=!0),null!=o&&(o=null,g=!0),null!=l&&(l=null,g=!0),null!=u&&(u=null,g=!0),null!=p&&(p=null,g=!0),g&&h.call(c,i||c),void 0;switch(e.toLowerCase()){case"ahex":case"hex":var m=s.hexToRgba(t&&(t.ahex||t.hex)||t||"00000000");f.call(c,"rgba",{r:m.r,g:m.g,b:m.b,a:"ahex"==e?m.a:null!=o?o:255},i);break;default:if(t&&(null!=t.ahex||null!=t.hex))return f.call(c,"ahex",t.ahex||t.hex||"00000000",i),void 0;var y={},b=!1,w=!1;void 0!==t.r&&-1==!e.indexOf("r")&&(e+="r"),void 0!==t.g&&-1==!e.indexOf("g")&&(e+="g"),void 0!==t.b&&-1==!e.indexOf("b")&&(e+="b"),void 0!==t.a&&-1==!e.indexOf("a")&&(e+="a"),void 0!==t.h&&-1==!e.indexOf("h")&&(e+="h"),void 0!==t.s&&-1==!e.indexOf("s")&&(e+="s"),void 0!==t.v&&-1==!e.indexOf("v")&&(e+="v");for(var v=0;e.length>v;v++)switch(e.charAt(v)){case"r":if(w)continue;b=!0,y.r=t&&t.r&&0|t.r||t&&0|t||0,0>y.r?y.r=0:y.r>255&&(y.r=255),n!=y.r&&(n=y.r,g=!0);break;case"g":if(w)continue;b=!0,y.g=t&&t.g&&0|t.g||t&&0|t||0,0>y.g?y.g=0:y.g>255&&(y.g=255),a!=y.g&&(a=y.g,g=!0);break;case"b":if(w)continue;b=!0,y.b=t&&t.b&&0|t.b||t&&0|t||0,0>y.b?y.b=0:y.b>255&&(y.b=255),r!=y.b&&(r=y.b,g=!0);break;case"a":y.a=t&&null!=t.a?0|t.a:null!=t?0|t:255,0>y.a?y.a=0:y.a>255&&(y.a=255),o!=y.a&&(o=y.a,g=!0);break;case"h":if(b)continue;w=!0,y.h=t&&t.h&&0|t.h||t&&0|t||0,0>y.h?y.h=0:y.h>360&&(y.h=360),l!=y.h&&(l=y.h,g=!0);break;case"s":if(b)continue;w=!0,y.s=t&&null!=t.s?0|t.s:null!=t?0|t:100,0>y.s?y.s=0:y.s>100&&(y.s=100),u!=y.s&&(u=y.s,g=!0);break;case"v":if(b)continue;w=!0,y.v=t&&null!=t.v?0|t.v:null!=t?0|t:100,0>y.v?y.v=0:y.v>100&&(y.v=100),p!=y.v&&(p=y.v,g=!0)}if(g){if(b){n=n||0,a=a||0,r=r||0;var m=s.rgbToHsv({r:n,g:a,b:r});l=m.h,u=m.s,p=m.v}else if(w){l=l||0,u=null!=u?u:100,p=null!=p?p:100;var m=s.hsvToRgb({h:l,s:u,v:p});n=m.r,a=m.g,r=m.b}o=null!=o?o:255,h.call(c,i||c)}}}},m=function(t){e.isFunction(t)&&d.push(t)},v=function(t){if(e.isFunction(t))for(var i;-1!=(i=e.inArray(t,d));)d.splice(i,1)},g=function(){d=null};t(!0,c,{val:f,bind:m,unbind:v,destroy:g}),i&&(null!=i.ahex?f("ahex",i):null!=i.hex?f((null!=i.a?"a":"")+"hex",null!=i.a?{ahex:i.hex+s.intToHex(i.a)}:i):null!=i.r&&null!=i.g&&null!=i.b?f("rgb"+(null!=i.a?"a":""),i):null!=i.h&&null!=i.s&&null!=i.v&&f("hsv"+(null!=i.a?"a":""),i))},ColorMethods:{hexToRgba:function(e){if(e=this.validateHex(e),""==e)return{r:null,g:null,b:null,a:null};var t="00",i="00",n="00",a="255";return 6==e.length&&(e+="ff"),e.length>6?(t=e.substring(0,2),i=e.substring(2,4),n=e.substring(4,6),a=e.substring(6,e.length)):(e.length>4&&(t=e.substring(4,e.length),e=e.substring(0,4)),e.length>2&&(i=e.substring(2,e.length),e=e.substring(0,2)),e.length>0&&(n=e.substring(0,e.length))),{r:this.hexToInt(t),g:this.hexToInt(i),b:this.hexToInt(n),a:this.hexToInt(a)}},validateHex:function(e){return e=e.toLowerCase().replace(/[^a-f0-9]/g,""),e.length>8&&(e=e.substring(0,8)),e},rgbaToHex:function(e){return this.intToHex(e.r)+this.intToHex(e.g)+this.intToHex(e.b)+this.intToHex(e.a)},intToHex:function(e){var t=(0|e).toString(16);return 1==t.length&&(t="0"+t),t.toLowerCase()},hexToInt:function(e){return parseInt(e,16)},rgbToHsv:function(e){var t,i=e.r/255,n=e.g/255,a=e.b/255,r={h:0,s:0,v:0},o=0,s=0;return i>=n&&i>=a?(s=i,o=n>a?a:n):n>=a&&n>=i?(s=n,o=i>a?a:i):(s=a,o=n>i?i:n),r.v=s,r.s=s?(s-o)/s:0,r.s?(t=s-o,r.h=i==s?(n-a)/t:n==s?2+(a-i)/t:4+(i-n)/t,r.h=parseInt(60*r.h),0>r.h&&(r.h+=360)):r.h=0,r.s=0|100*r.s,r.v=0|100*r.v,r},hsvToRgb:function(e){var t={r:0,g:0,b:0,a:100},i=e.h,n=e.s,a=e.v;if(0==n)t.r=t.g=t.b=0==a?0:0|255*a/100;else{360==i&&(i=0),i/=60,n/=100,a/=100;var r=0|i,o=i-r,s=a*(1-n),l=a*(1-n*o),u=a*(1-n*(1-o));switch(r){case 0:t.r=a,t.g=u,t.b=s;break;case 1:t.r=l,t.g=a,t.b=s;break;case 2:t.r=s,t.g=a,t.b=u;break;case 3:t.r=s,t.g=l,t.b=a;break;case 4:t.r=u,t.g=s,t.b=a;break;case 5:t.r=a,t.g=s,t.b=l}t.r=0|255*t.r,t.g=0|255*t.g,t.b=0|255*t.b}return t}}};var r=e.wsjPicker.Color,o=e.wsjPicker.List,s=e.wsjPicker.ColorMethods;e.fn.wsjPicker=function(s){var l=arguments;return this.each(function(){var u=this,p=e.extend(!0,{},e.fn.wsjPicker.defaults,s);p.window.liveUpdate=!1;var c=null,d=null,h=null,f=null,m=null,v=null,g=null,y=null,b=null,w=null,T=null,x=null,N=null,E=null,k=null,A=null,C=null,S=null,D=null,M=null,O=function(e){var t,i,n=ot.active,a=(at.clientPath,n.val("hex"));switch(p.color.mode=e,e){case"h":if(setTimeout(function(){W.call(u,d,"transparent"),B.call(u,f,0),z.call(u,f,100),B.call(u,m,260),z.call(u,m,100),W.call(u,h,"transparent"),B.call(u,g,0),z.call(u,g,100),B.call(u,y,260),z.call(u,y,100),B.call(u,b,260),z.call(u,b,100),B.call(u,w,260),z.call(u,w,100),B.call(u,x,260),z.call(u,x,100)},0),N.range("all",{minX:0,maxX:100,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:360}),null==n.val("ahex"))break;N.val("xy",{x:n.val("s"),y:100-n.val("v")},N),E.val("y",360-n.val("h"),E);break;case"s":if(setTimeout(function(){W.call(u,d,"transparent"),B.call(u,f,-260),B.call(u,m,-520),B.call(u,g,-260),B.call(u,y,-520),B.call(u,x,260),z.call(u,x,100)},0),N.range("all",{minX:0,maxX:360,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:100}),null==n.val("ahex"))break;N.val("xy",{x:n.val("h"),y:100-n.val("v")},N),E.val("y",100-n.val("s"),E);break;case"v":if(setTimeout(function(){W.call(u,d,"000000"),B.call(u,f,-780),B.call(u,m,260),W.call(u,h,a),B.call(u,g,-520),B.call(u,y,260),z.call(u,y,100),B.call(u,x,260),z.call(u,x,100)},0),N.range("all",{minX:0,maxX:360,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:100}),null==n.val("ahex"))break;N.val("xy",{x:n.val("h"),y:100-n.val("s")},N),E.val("y",100-n.val("v"),E);break;case"r":if(t=-1040,i=-780,N.range("all",{minX:0,maxX:255,minY:0,maxY:255}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;N.val("xy",{x:n.val("b"),y:255-n.val("g")},N),E.val("y",255-n.val("r"),E);break;case"g":if(t=-1560,i=-1820,N.range("all",{minX:0,maxX:255,minY:0,maxY:255}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;N.val("xy",{x:n.val("b"),y:255-n.val("r")},N),E.val("y",255-n.val("g"),E);break;case"b":if(t=-2080,i=-2860,N.range("all",{minX:0,maxX:255,minY:0,maxY:255}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;N.val("xy",{x:n.val("r"),y:255-n.val("g")},N),E.val("y",255-n.val("b"),E);break;case"a":if(setTimeout(function(){W.call(u,d,"transparent"),B.call(u,f,-260),B.call(u,m,-520),B.call(u,g,260),B.call(u,y,260),z.call(u,y,100),B.call(u,x,0),z.call(u,x,100)},0),N.range("all",{minX:0,maxX:360,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;N.val("xy",{x:n.val("h"),y:100-n.val("v")},N),E.val("y",255-n.val("a"),E);break;default:throw"Invalid Mode"}switch(e){case"h":break;case"s":case"v":case"a":setTimeout(function(){z.call(u,f,100),z.call(u,g,100),B.call(u,b,260),z.call(u,b,100),B.call(u,w,260),z.call(u,w,100)},0);break;case"r":case"g":case"b":setTimeout(function(){W.call(u,d,"transparent"),W.call(u,h,"transparent"),z.call(u,g,100),z.call(u,f,100),B.call(u,f,t),B.call(u,m,t-260),B.call(u,g,i-780),B.call(u,y,i-520),B.call(u,b,i),B.call(u,w,i-260),B.call(u,x,260),z.call(u,x,100)},0)}null!=n.val("ahex")&&P.call(u,n)},P=function(e,t){(null==t||t!=E&&t!=N)&&I.call(u,e,t),setTimeout(function(){L.call(u,e),j.call(u,e),V.call(u,e)},0)},_=function(e,t){var i=ot.active;if(t==N||null!=i.val()){var n=e.val("all");switch(p.color.mode){case"h":i.val("sv",{s:n.x,v:100-n.y},t);break;case"s":case"a":i.val("hv",{h:n.x,v:100-n.y},t);break;case"v":i.val("hs",{h:n.x,s:100-n.y},t);break;case"r":i.val("gb",{g:255-n.y,b:n.x},t);break;case"g":i.val("rb",{r:255-n.y,b:n.x},t);break;case"b":i.val("rg",{r:n.x,g:255-n.y},t)}}},F=function(e,t){var i=ot.active;if(t==E||null!=i.val())switch(p.color.mode){case"h":i.val("h",{h:360-e.val("y")},t);break;case"s":i.val("s",{s:100-e.val("y")},t);break;case"v":i.val("v",{v:100-e.val("y")},t);break;case"r":i.val("r",{r:255-e.val("y")},t);break;case"g":i.val("g",{g:255-e.val("y")},t);break;case"b":i.val("b",{b:255-e.val("y")},t);break;case"a":i.val("a",255-e.val("y"),t)}},I=function(e,t){if(t!=N)switch(p.color.mode){case"h":var i=e.val("sv");N.val("xy",{x:null!=i?i.s:100,y:100-(null!=i?i.v:100)},t);break;case"s":case"a":var n=e.val("hv");N.val("xy",{x:n&&n.h||0,y:100-(null!=n?n.v:100)},t);break;case"v":var a=e.val("hs");N.val("xy",{x:a&&a.h||0,y:100-(null!=a?a.s:100)},t);break;case"r":var r=e.val("bg");N.val("xy",{x:r&&r.b||0,y:255-(r&&r.g||0)},t);break;case"g":var o=e.val("br");N.val("xy",{x:o&&o.b||0,y:255-(o&&o.r||0)},t);break;case"b":var s=e.val("rg");N.val("xy",{x:s&&s.r||0,y:255-(s&&s.g||0)},t)}if(t!=E)switch(p.color.mode){case"h":E.val("y",360-(e.val("h")||0),t);break;case"s":var l=e.val("s");E.val("y",100-(null!=l?l:100),t);break;case"v":var u=e.val("v");E.val("y",100-(null!=u?u:100),t);break;case"r":E.val("y",255-(e.val("r")||0),t);break;case"g":E.val("y",255-(e.val("g")||0),t);break;case"b":E.val("y",255-(e.val("b")||0),t);break;case"a":var c=e.val("a");E.val("y",255-(null!=c?c:255),t)}},L=function(e){try{var t=e.val("all");A.css({backgroundColor:t&&"#"+t.hex||"transparent"}),z.call(u,A,t&&Math.precision(100*t.a/255,4)||0)}catch(i){}},j=function(e){switch(p.color.mode){case"h":W.call(u,d,new r({h:e.val("h")||0,s:100,v:100}).val("hex"));break;case"s":case"a":var t=e.val("s");z.call(u,m,100-(null!=t?t:100));break;case"v":var i=e.val("v");z.call(u,f,null!=i?i:100);break;case"r":z.call(u,m,Math.precision(100*((e.val("r")||0)/255),4));break;case"g":z.call(u,m,Math.precision(100*((e.val("g")||0)/255),4));break;case"b":z.call(u,m,Math.precision(100*((e.val("b")||0)/255)))}var n=e.val("a");z.call(u,v,Math.precision(100*(255-(n||0))/255,4))},V=function(e){switch(p.color.mode){case"h":var t=e.val("a");z.call(u,T,Math.precision(100*(255-(t||0))/255,4));break;case"s":var i=e.val("hva"),n=new r({h:i&&i.h||0,s:100,v:null!=i?i.v:100});W.call(u,h,n.val("hex")),z.call(u,y,100-(null!=i?i.v:100)),z.call(u,T,Math.precision(100*(255-(i&&i.a||0))/255,4));break;case"v":var a=e.val("hsa"),o=new r({h:a&&a.h||0,s:null!=a?a.s:100,v:100});W.call(u,h,o.val("hex")),z.call(u,T,Math.precision(100*(255-(a&&a.a||0))/255,4));break;case"r":case"g":case"b":var s=0,l=0,c=e.val("rgba");"r"==p.color.mode?(s=c&&c.b||0,l=c&&c.g||0):"g"==p.color.mode?(s=c&&c.b||0,l=c&&c.r||0):"b"==p.color.mode&&(s=c&&c.r||0,l=c&&c.g||0);var d=l>s?s:l;z.call(u,y,s>l?Math.precision(100*((s-l)/(255-l)),4):0),z.call(u,b,l>s?Math.precision(100*((l-s)/(255-s)),4):0),z.call(u,w,Math.precision(100*(d/255),4)),z.call(u,T,Math.precision(100*(255-(c&&c.a||0))/255,4));break;case"a":var t=e.val("a");W.call(u,h,e.val("hex")||"000000"),z.call(u,T,null!=t?0:100),z.call(u,x,null!=t?100:0)}},W=function(e,t){e.css({backgroundColor:t&&6==t.length&&"#"+t||"transparent"})},R=function(e,t){e.css({backgroundImage:"url('"+t+"')"})},B=function(e,t){e.css({top:t+"px"})},z=function(e,t){e.css({visibility:t>0?"visible":"hidden"}),t>0&&100>t?e.css({opacity:Math.precision(t/100,4)}):(0==t||100==t)&&e.css({opacity:""})},H=function(){ot.active.val("ahex",ot.current.val("ahex"))},U=function(){ot.current.val("ahex",ot.active.val("ahex"))},q=function(t){e(this).parents("tbody:first").find('input:radio[value!="'+t.target.value+'"]').prop("checked",!1),O.call(u,t.target.value)},Q=function(){H.call(u)},$=function(){H.call(u),e.isFunction(Z)&&Z.call(u,ot.active,D)},J=function(){U.call(u),e.isFunction(X)&&X.call(u,ot.active,S)},Y=function(e){var t=e.val("hex");C.css({backgroundColor:t&&"#"+t||"transparent"}),z.call(u,C,Math.precision(100*(e.val("a")||0)/255,4))},G=function(t){return t.preventDefault(),t.stopPropagation(),ot.active.val("ahex",e(this).attr("title")||null,t.target),!1},X=e.isFunction(l[1])&&l[1]||null,K=e.isFunction(l[2])&&l[2]||null,Z=e.isFunction(l[3])&&l[3]||null,et=function(){ot.current.val("ahex",ot.active.val("ahex"))},tt=function(){},it=function(){var t=p.window;c=e(u),c.addClass("jPicker Container"),c.get(0).onselectstart=function(e){return"input"!==e.target.nodeName.toLowerCase()?!1:void 0};var o=ot.active.val("all");0>t.alphaPrecision?t.alphaPrecision=0:t.alphaPrecision>2&&(t.alphaPrecision=2);var s='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody><tr><td rowspan="9"><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+at.clientPath+at.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+at.clientPath+at.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview">'+rt.text.newColor+'<div><span class="Active" title="'+rt.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+rt.tooltips.colors.currentColor+'">&nbsp;</span></div>'+rt.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+rt.text.ok+'" title="'+rt.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+rt.text.cancel+'" title="'+rt.tooltips.buttons.cancel+'"/><hr/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label><input type="radio" aria-label="'+rt.tooltips.hue.radio+'" class="hue-radio" value="h"'+("h"==p.color.mode?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.h:"")+'" title="'+rt.tooltips.hue.textbox+'"/>&nbsp;&deg;</td></tr><tr class="Saturation"><td class="Radio"><label><input type="radio" aria-label="'+rt.tooltips.saturation.radio+'" value="s"'+("s"==p.color.mode?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.s:"")+'" title="'+rt.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label><input type="radio" aria-label="'+rt.tooltips.value.radio+'" value="v"'+("v"==p.color.mode?' checked="checked"':"")+'/>V:</label><br/><br/></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.v:"")+'" title="'+rt.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label><input type="radio" aria-label="'+rt.tooltips.red.radio+'" value="r"'+("r"==p.color.mode?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.r:"")+'" title="'+rt.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label><input type="radio" title="'+rt.tooltips.green.radio+'" value="g"'+("g"==p.color.mode?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.g:"")+'" title="'+rt.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label><input type="radio"  aria-label="'+rt.tooltips.blue.radio+'" value="b"'+("b"==p.color.mode?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.b:"")+'" title="'+rt.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio"><label><input aria-label="'+rt.tooltips.alpha.radio+'" class="alpha-radio" type="radio" value="a"'+("a"==p.color.mode?' checked="checked"':"")+'/>A:</label></td><td class="Text"><input type="text" maxlength="'+(3+t.alphaPrecision)+'" value="'+(null!=o?Math.precision(100*o.a/255,t.alphaPrecision):"")+'" title="'+rt.tooltips.alpha.textbox+'"/>&nbsp;%</td></tr><tr class="Hex"><td colspan="2" class="Text"><label>#:<input  aria-label="'+rt.tooltips.hex.textbox+'" type="text" maxlength="6" class="Hex" value="'+(null!=o?o.hex:"")+'"/></label><input type="text" maxlength="2" class="AHex" value="'+(null!=o?o.ahex.substring(6):"")+'" title="'+rt.tooltips.hex.alpha+'"/></td></tr></tbody></table>';c=e(u),c.html(s);var l=c.find("tbody").eq(0);d=l.find("div.Map").eq(0),h=l.find("div.Bar").eq(0);var I=d.find("span"),L=h.find("span");f=I.filter(".Map1").eq(0),m=I.filter(".Map2").eq(0),v=I.filter(".Map3").eq(0),g=L.filter(".Map1").eq(0),y=L.filter(".Map2").eq(0),b=L.filter(".Map3").eq(0),w=L.filter(".Map4").eq(0),T=L.filter(".Map5").eq(0),x=L.filter(".Map6").eq(0),N=new n(d,{map:{width:at.colorMap.width,height:at.colorMap.height},arrow:{image:at.clientPath+at.colorMap.arrow.file,width:at.colorMap.arrow.width,height:at.colorMap.arrow.height}}),N.bind(_),E=new n(h,{map:{width:at.colorBar.width,height:at.colorBar.height},arrow:{image:at.clientPath+at.colorBar.arrow.file,width:at.colorBar.arrow.width,height:at.colorBar.arrow.height}}),E.bind(F),k=new a(l,ot.active,null,t.alphaPrecision);var j=null!=o?o.hex:null,V=l.find(".Preview"),W=l.find(".Button");if(A=V.find(".Active:first").css({backgroundColor:j&&"#"+j||"transparent"}),C=V.find(".Current:first").css({backgroundColor:j&&"#"+j||"transparent"}).bind("click",Q),z.call(u,C,Math.precision(100*ot.current.val("a"))/255,4),S=W.find(".Ok:first").bind("click",J),D=W.find(".Cancel:first").bind("click",$),M=W.find(".Grid:first"),setTimeout(function(){R.call(u,f,at.clientPath+"Maps.png"),R.call(u,m,at.clientPath+"Maps.png"),R.call(u,v,at.clientPath+"map-opacity.png"),R.call(u,g,at.clientPath+"Bars.png"),R.call(u,y,at.clientPath+"Bars.png"),R.call(u,b,at.clientPath+"Bars.png"),R.call(u,w,at.clientPath+"Bars.png"),R.call(u,T,at.clientPath+"bar-opacity.png"),R.call(u,x,at.clientPath+"AlphaBar.png"),R.call(u,V.find("div").eq(0),at.clientPath+"preview-opacity.png")},0),l.find("td.Radio input").bind("click",q),ot.quickList&&ot.quickList.length>0){var B="";for(i=0;ot.quickList.length>i;i++){"string"==(""+typeof ot.quickList[i]).toLowerCase()&&(ot.quickList[i]=new r({hex:ot.quickList[i]}));var H=ot.quickList[i].val("a"),U=ot.quickList[i].val("ahex");!t.alphaSupport&&U&&(U=U.substring(0,6)+"ff");var X=ot.quickList[i].val("hex");B+='<span class="QuickColor"'+(U&&' title="#'+U+'"'||"")+' style="background-color:'+(X&&"#"+X||"")+";"+(X?"":"background-image:url("+at.clientPath+"NoColor.png)")+(t.alphaSupport&&H&&255>H?";opacity:"+Math.precision(H/255,4)+";filter:Alpha(opacity="+Math.precision(H/2.55,4)+")":"")+'">&nbsp;</span>'}R.call(u,M,at.clientPath+"bar-opacity.png"),M.html(B),M.find(".QuickColor").click(G)}O.call(u,p.color.mode),ot.active.bind(P),e.isFunction(K)&&ot.active.bind(K),ot.current.bind(Y),et.call(u)},nt=function(){var t=e.data(u,"wsjPicker")||u;for(c.find("td.Radio input").unbind("click",q),C.unbind("click",Q),D.unbind("click",$),S.unbind("click",J),c.find(".QuickColor").unbind("click",G),d=null,h=null,f=null,m=null,v=null,g=null,y=null,b=null,w=null,T=null,x=null,N.destroy(),N=null,E.destroy(),E=null,k.destroy(),k=null,A=null,C=null,S=null,D=null,M=null,X=null,Z=null,K=null,c.html(""),i=0;o.length>i;i++)if(o[i]==t){o.splice(i,1);break}},at=p.images,rt=p.localization,ot={active:"string"==(""+typeof p.color.active).toLowerCase()?new r({ahex:!p.window.alphaSupport&&p.color.active?p.color.active.substring(0,6)+"ff":p.color.active}):new r({ahex:!p.window.alphaSupport&&p.color.active.val("ahex")?p.color.active.val("ahex").substring(0,6)+"ff":p.color.active.val("ahex")}),current:"string"==(""+typeof p.color.active).toLowerCase()?new r({ahex:!p.window.alphaSupport&&p.color.active?p.color.active.substring(0,6)+"ff":p.color.active}):new r({ahex:!p.window.alphaSupport&&p.color.active.val("ahex")?p.color.active.val("ahex").substring(0,6)+"ff":p.color.active.val("ahex")}),quickList:p.color.quickList};t(!0,u,{commitCallback:X,liveCallback:K,cancelCallback:Z,color:ot,show:et,hide:tt,destroy:nt}),o.push(e.data(u,"wsjPicker")||u),setTimeout(function(){it.call(u)},0)})},e.fn.wsjPicker.defaults={window:{title:null,expandable:!1,liveUpdate:!0,alphaSupport:!1,alphaPrecision:0},color:{mode:"h",active:new r({ahex:"#ffcc00ff"}),quickList:[new r({h:360,s:33,v:100}),new r({h:360,s:66,v:100}),new r({h:360,s:100,v:100}),new r({h:360,s:100,v:75}),new r({h:360,s:100,v:50}),new r({h:180,s:0,v:100}),new r({h:30,s:33,v:100}),new r({h:30,s:66,v:100}),new r({h:30,s:100,v:100}),new r({h:30,s:100,v:75}),new r({h:30,s:100,v:50}),new r({h:180,s:0,v:90}),new r({h:60,s:33,v:100}),new r({h:60,s:66,v:100}),new r({h:60,s:100,v:100}),new r({h:60,s:100,v:75}),new r({h:60,s:100,v:50}),new r({h:180,s:0,v:80}),new r({h:90,s:33,v:100}),new r({h:90,s:66,v:100}),new r({h:90,s:100,v:100}),new r({h:90,s:100,v:75}),new r({h:90,s:100,v:50}),new r({h:180,s:0,v:70}),new r({h:120,s:33,v:100}),new r({h:120,s:66,v:100}),new r({h:120,s:100,v:100}),new r({h:120,s:100,v:75}),new r({h:120,s:100,v:50}),new r({h:180,s:0,v:60}),new r({h:150,s:33,v:100}),new r({h:150,s:66,v:100}),new r({h:150,s:100,v:100}),new r({h:150,s:100,v:75}),new r({h:150,s:100,v:50}),new r({h:180,s:0,v:50}),new r({h:180,s:33,v:100}),new r({h:180,s:66,v:100}),new r({h:180,s:100,v:100}),new r({h:180,s:100,v:75}),new r({h:180,s:100,v:50}),new r({h:180,s:0,v:40}),new r({h:210,s:33,v:100}),new r({h:210,s:66,v:100}),new r({h:210,s:100,v:100}),new r({h:210,s:100,v:75}),new r({h:210,s:100,v:50}),new r({h:180,s:0,v:30}),new r({h:240,s:33,v:100}),new r({h:240,s:66,v:100}),new r({h:240,s:100,v:100}),new r({h:240,s:100,v:75}),new r({h:240,s:100,v:50}),new r({h:180,s:0,v:20}),new r({h:270,s:33,v:100}),new r({h:270,s:66,v:100}),new r({h:270,s:100,v:100}),new r({h:270,s:100,v:75}),new r({h:270,s:100,v:50}),new r({h:180,s:0,v:10}),new r({h:300,s:33,v:100}),new r({h:300,s:66,v:100}),new r({h:300,s:100,v:100}),new r({h:300,s:100,v:75}),new r({h:300,s:100,v:50}),new r({h:180,s:0,v:0}),new r({h:330,s:33,v:100}),new r({h:330,s:66,v:100}),new r({h:330,s:100,v:100}),new r({h:330,s:100,v:75}),new r({h:330,s:100,v:50}),new r({h:180,s:0,v:0})]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6wsmod"),jQuery.webshims.register("forms-picker",function(e,t,i,n,a,r){var o=t.picker,s={changeInput:function(e,t,i){s.cancel(e,t,i),i.setChange(e)},cancel:function(e,t,i){t.stopOpen=!0,i.element.getShadowFocusElement().focus(),setTimeout(function(){t.stopOpen=!1},9),t.hide()}},l=r,u=function(e){var t=[e.getFullYear(),l.addZero(e.getMonth()+1),l.addZero(e.getDate())];return t.month=t[0]+"-"+t[1],t.date=t[0]+"-"+t[1]+"-"+t[2],t},p=u(new Date),c=function(t,i){t=e(t||this.activeButton),this.popover.openedByFocus||i||(that=this,setFocus=function(e){clearTimeout(that.timer),that.timer=setTimeout(function(){t[0]&&(t[0].focus(),e===!0||t.is(":focus")||setFocus(!0))
},that.popover.isVisible?99:360)},this.popover.activateElement(t),setFocus())},d=function(t){t=e(t||this.activeButton),this.activeButton.attr({tabindex:"-1","aria-selected":"false"}),this.activeButton=t.attr({tabindex:"0","aria-selected":"true"}),this.index=this.buttons.index(this.activeButton[0]),clearTimeout(this.timer),c.apply(this,arguments)},h=function(){var t;this.popover.navedInitFocus&&(t=this.popover.navedInitFocus.sel||this.popover.navedInitFocus,this.activeButton&&this.activeButton[0]||!this.buttons[t]?t&&(this.activeButton=e(t,this.element)):this.activeButton=this.buttons[t](),!this.activeButton[0]&&this.popover.navedInitFocus.alt&&(this.activeButton=this.buttons[this.popover.navedInitFocus.alt]())),this.activeButton&&this.activeButton[0]||(this.activeButton=this.buttons.filter(".checked-value")),this.activeButton[0]||(this.activeButton=this.buttons.filter(".this-value")),this.activeButton[0]||(this.activeButton=this.buttons.eq(0)),this.setFocus(this.activeButton,this.opts.noFocus)},f=t.formcfg,m=f[e.webshims.activeLang()]||f[""];e.webshims.activeLang({register:"form-core",callback:function(){e.each(arguments,function(e,t){return f[t]?(m=f[t],!1):a})}}),t.ListBox=function(t,i,n){this.element=e("ul",t),this.popover=i,this.opts=n||{},this.buttons=e("button:not(:disabled)",this.element),this.ons(this),this._initialFocus()},t.ListBox.prototype={setFocus:d,_initialFocus:h,prev:function(){var e=this.index-1;0>e?this.opts.prev&&(this.popover.navedInitFocus="last",this.popover.actionFn(this.opts.prev),this.popover.navedInitFocus=!1):this.setFocus(this.buttons.eq(e))},next:function(){var e=this.index+1;e>=this.buttons.length?this.opts.next&&(this.popover.navedInitFocus="first",this.popover.actionFn(this.opts.next),this.popover.navedInitFocus=!1):this.setFocus(this.buttons.eq(e))},ons:function(e){this.element.on({keydown:function(t){var i,n=t.keyCode;return t.ctrlKey?a:(36==n||33==n?(e.setFocus(e.buttons.eq(0)),i=!0):34==n||35==n?(e.setFocus(e.buttons.eq(e.buttons.length-1)),i=!0):38==n||37==n?(e.prev(),i=!0):(40==n||39==n)&&(e.next(),i=!0),i?!1:a)}})}},t.Grid=function(t,i,n){this.element=e("tbody",t),this.popover=i,this.opts=n||{},this.buttons=e("button:not(:disabled,.othermonth)",this.element),this.ons(this),this._initialFocus(),this.popover.openedByFocus&&(this.popover.activeElement=this.activeButton)},t.Grid.prototype={setFocus:d,_initialFocus:h,first:function(){this.setFocus(this.buttons.eq(0))},last:function(){this.setFocus(this.buttons.eq(this.buttons.length-1))},upPage:function(){e(".ws-picker-header > button:not(:disabled)",this.popover.element).trigger("click")},downPage:function(){this.activeButton.filter(':not([data-action="changeInput"])').trigger("click")},ons:function(e){this.element.on({keydown:function(t){var i,n=t.keyCode;return t.shiftKey?a:(t.ctrlKey&&40==n?i="downPage":t.ctrlKey&&38==n?i="upPage":33==n||t.ctrlKey&&37==n?i="prevPage":34==n||t.ctrlKey&&39==n?i="nextPage":36==t.keyCode||33==t.keyCode?i="first":35==t.keyCode?i="last":38==t.keyCode?i="up":37==t.keyCode?i="prev":40==t.keyCode?i="down":39==t.keyCode&&(i="next"),i?(e[i](),!1):a)}})}},e.each({prevPage:{get:"last",action:"prev"},nextPage:{get:"first",action:"next"}},function(e,i){t.Grid.prototype[e]=function(){this.opts[i.action]&&(this.popover.navedInitFocus={sel:'button[data-id="'+this.activeButton.attr("data-id")+'"]:not(:disabled,.othermonth)',alt:i.get},this.popover.actionFn(this.opts[i.action]),this.popover.navedInitFocus=!1)}}),e.each({up:{traverse:"prevAll",get:"last",action:"prev",reverse:!0},down:{traverse:"nextAll",get:"first",action:"next"}},function(i,n){t.Grid.prototype[i]=function(){var t=this.activeButton.closest("td").prop("cellIndex"),i="td:nth-child("+(t+1)+") button:not(:disabled,.othermonth)",a=this.activeButton.closest("tr")[n.traverse]();n.reverse&&(a=e(a.get().reverse())),a=a.find(i)[n.get](),a[0]?this.setFocus(a.eq(0)):this.opts[n.action]&&(this.popover.navedInitFocus=i+":"+n.get,this.popover.actionFn(this.opts[n.action]),this.popover.navedInitFocus=!1)}}),e.each({prev:{traverse:"prevAll",get:"last",reverse:!0},next:{traverse:"nextAll",get:"first"}},function(i,n){t.Grid.prototype[i]=function(){var t="button:not(:disabled,.othermonth)",a=this.activeButton.closest("td")[n.traverse]("td");n.reverse&&(a=e(a.get().reverse())),a=a.find(t)[n.get](),a[0]||(a=this.activeButton.closest("tr")[n.traverse]("tr"),n.reverse&&(a=e(a.get().reverse())),a=a.find(t)[n.get]()),a[0]?this.setFocus(a.eq(0)):this.opts[i]&&(this.popover.navedInitFocus=n.get,this.popover.actionFn(this.opts[i]),this.popover.navedInitFocus=!1)}}),o.getWeek=function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},o.getYearList=function(e,t){var i,n,a,r,s,l,u,c,d,h,f=t.options.size,m=t.options.max.split("-"),v=t.options.min.split("-"),g=t.options.value.split("-"),y=0,b=0,w="",T=0;for("max"==t.options.useDecadeBase&&m[0]?y=11-m[0]%12:"min"==t.options.useDecadeBase&&v[0]&&(y=11-v[0]%12),e=1*e[0],h=e-(e+y)%(12*f),i=0;f>i;i++){for(i?h+=12:l=o.isInRange([h-1],m,v)?{"data-action":"setYearList",value:h-1}:!1,w+='<div class="year-list picker-list ws-index-'+i+'"><div class="ws-picker-header"><button disabled="disabled">'+h+" – "+(h+11)+"</button></div>",s=[],n=0;12>n;n++)a=h+n,d=[],o.isInRange([a],m,v)?(r="",b++):r=' disabled=""',a==p[0]&&d.push("this-value"),g[0]==a&&d.push("checked-value"),c=d.length?' class="'+d.join(" ")+'"':"",!n||n%3||(T++,s.push('</tr><tr class="ws-row-'+T+'">')),s.push('<td class="ws-item-'+n+'" role="presentation"><button  data-id="year-'+n+'" type="button"'+r+c+' data-action="setMonthList" value="'+a+'" tabindex="-1" role="gridcell">'+a+"</button></td>");i==f-1&&(u=o.isInRange([a+1],m,v)?{"data-action":"setYearList",value:a+1}:!1),w+='<div class="picker-grid"><table role="grid" aria-label="'+h+" – "+(h+11)+'"><tbody><tr class="ws-row-0">'+s.join("")+"</tr></tbody></table></div></div>"}return{enabled:b,main:w,next:u,prev:l,type:"Grid"}},o.getMonthList=function(e,t){var i,n,a,r,s,l,u,c,d,h,f,v=t.options,g=v.size,y=v.max.split("-"),b=v.min.split("-"),w=v.value.split("-"),T=0,x=0,N="";for(e=e[0]-Math.floor((g-1)/2),i=0;g>i;i++){for(i?e++:c=o.isInRange([e-1],y,b)?{"data-action":"setMonthList",value:e-1}:!1,i==g-1&&(d=o.isInRange([e+1],y,b)?{"data-action":"setMonthList",value:e+1}:!1),l=[],o.isInRange([e,"01"],y,b)||o.isInRange([e,"12"],y,b)?(u=!1,s=""):(s=' disabled=""',u=!0),v.minView>=1&&(s=' disabled=""'),N+='<div class="month-list picker-list ws-index-'+i+'"><div class="ws-picker-header">',N+=v.selectNav?'<select data-action="setMonthList" class="year-select">'+o.createYearSelect(e,y,b).join("")+"</select>":'<button data-action="setYearList"'+s+' value="'+e+'" tabindex="-1">'+e+"</button>",N+="</div>",n=0;12>n;n++)r=m.date.monthkeys[n+1],a=(m.date[v.monthNames]||m.date.monthNames)[n],f=[],u||!o.isInRange([e,r],y,b)?s=' disabled=""':(s="",T++),e==p[0]&&p[1]==r&&f.push("this-value"),w[0]==e&&w[1]==r&&f.push("checked-value"),h=f.length?' class="'+f.join(" ")+'"':"",!n||n%3||(x++,l.push('</tr><tr class="ws-row-'+x+'">')),l.push('<td class="ws-item-'+n+'" role="presentation"><button data-id="month-'+n+'" type="button"'+s+h+' data-action="'+("month"==t.type?"changeInput":"setDayList")+'" value="'+e+"-"+r+'" tabindex="-1" role="gridcell" aria-label="'+m.date.monthNames[n]+'">'+a+"</button></td>");N+='<div class="picker-grid"><table role="grid" aria-label="'+e+'"><tbody><tr class="ws-row-0">'+l.join("")+"</tr></tbody></table></div></div>"}return{enabled:T,main:N,prev:c,next:d,type:"Grid"}},o.getDayList=function(t,i){var n,a,r,s,l,c,d,h,f,v,g,y,b,w,T,x,N,E,k,A=i.options,C=A.size,S=A.max.split("-"),D=A.min.split("-"),M=A.value.split("-"),O=m.date[A.monthNamesHead]||m.date[A.monthNames]||m.date.monthNames,P=[],_=new Date(t[0],t[1]-1,1);for(_.setMonth(_.getMonth()-Math.floor((C-1)/2)),n=0;C>n;n++){for(_.setDate(1),g=_.getMonth(),v=0,n||(E=new Date(_.getTime()),E.setDate(-1),w=u(E),c=o.isInRange(w,S,D)?{"data-action":"setDayList",value:w[0]+"-"+w[1]}:!1),w=u(_),P.push('<div class="day-list picker-list ws-index-'+n+'"><div class="ws-picker-header">'),A.selectNav&&(T=['<select data-action="setDayList" class="month-select" tabindex="0">'+o.createMonthSelect(w,S,D,O).join("")+"</select>",'<select data-action="setDayList" class="year-select" tabindex="0">'+o.createYearSelect(w[0],S,D,"-"+w[1]).join("")+"</select>"],m.date.showMonthAfterYear&&T.reverse(),P.push(T.join(" "))),x=[m.date.monthNames[1*w[1]-1],w[0]],T=[O[1*w[1]-1],w[0]],m.date.showMonthAfterYear&&(T.reverse(),x.reverse()),i.options.selectNav||P.push('<button data-action="setMonthList"'+(A.minView>=2?' disabled="" ':"")+' value="'+w.date+'" tabindex="-1">'+T.join(" ")+"</button>"),P.push('</div><div class="picker-grid"><table role="grid" aria-label="'+x.join(" ")+'"><thead><tr>'),i.options.showWeek&&P.push('<th class="week-header">'+m.date.weekHeader+"</th>"),r=m.date.firstDay;m.date.dayNamesShort.length>r;r++)P.push('<th class="day-'+r+'"><abbr title="'+m.date.dayNames[r]+'">'+m.date.dayNamesShort[r]+"</abbr></th>");for(r=m.date.firstDay;r--;)P.push('<th class="day-'+r+'"><abbr title="'+m.date.dayNames[r]+'">'+m.date.dayNamesShort[r]+"</abbr></th>");for(P.push('</tr></thead><tbody><tr class="ws-row-0">'),i.options.showWeek&&(f=o.getWeek(_),P.push('<td class="week-cell">'+f+"</td>")),a=0;99>a;a++){if(h=a&&!(a%7),y=_.getMonth(),b=g!=y,s=_.getDay(),k=[],h&&b){P.push("</tr>");break}h&&(v++,P.push('</tr><tr class="ws-row-'+v+'">'),i.options.showWeek&&(f++,P.push('<td class="week-cell">'+f+"</td>"))),a||s!=m.date.firstDay&&(l=s-m.date.firstDay,0>l&&(l+=7),_.setDate(_.getDate()-l),s=_.getDay(),y=_.getMonth(),b=g!=y),w=u(_),N='<td role="presentation" class="day-'+s+'"><button data-id="day-'+_.getDate()+'" role="gridcell" data-action="changeInput" value="'+w.join("-")+'"',b?k.push("othermonth"):k.push("day-"+_.getDate()),w[0]==p[0]&&p[1]==w[1]&&p[2]==w[2]&&k.push("this-value"),M[0]==w[0]&&w[1]==M[1]&&w[2]==M[2]&&k.push("checked-value"),k.length&&(N+=' class="'+k.join(" ")+'"'),(!o.isInRange(w,S,D)||i.options.disableDays&&-1!=e.inArray(s,i.options.disableDays))&&(N+=' disabled=""'),P.push(N+' tabindex="-1">'+_.getDate()+"</button></td>"),_.setDate(_.getDate()+1)}P.push("</tbody></table></div></div>"),n==C-1&&(w=u(_),w[2]=1,d=o.isInRange(w,S,D)?{"data-action":"setDayList",value:w.date}:!1)}return{enabled:9,main:P.join(""),prev:c,next:d,type:"Grid"}},o.isInRange=function(e,t,i){var n,a=!0;for(n=0;e.length>n;n++){if(i[n]&&i[n]>e[n]){a=!1;break}if(!i[n]||i[n]!=e[n])break}if(a)for(n=0;e.length>n;n++){if(t[n]&&t[n]<e[n]){a=!1;break}if(!t[n]||t[n]!=e[n])break}return a},o.createMonthSelect=function(e,t,i,n){n||(n=m.date.monthNames);for(var a,r=0,s=[],u=e[1]-1;n.length>r;r++)a=u==r?' selected=""':"",(a||o.isInRange([e[0],r+1],t,i))&&s.push('<option value="'+e[0]+"-"+l.addZero(r+1)+'"'+a+">"+n[r]+"</option>");return s},o.createYearSelect=function(e,t,i,n){var a,r=!0,s=!0,l=['<option selected="">'+e+"</option>"],u=0;for(n||(n="");8>u&&(r||s);)u++,a=e-u,r&&o.isInRange([a],t,i)?l.unshift('<option value="'+(a+n)+'">'+a+"</option>"):r=!1,a=e+u,s&&o.isInRange([a],t,i)?l.push('<option value="'+(a+n)+'">'+a+"</option>"):s=!1;return l},function(){var i=function(e){return"get"+e+"List"},n=function(e){return"set"+e+"List"},a={date:"Day",week:"Day",month:"Month"};e.each({setYearList:["Year","Month","Day"],setMonthList:["Month","Day"],setDayList:["Day"]},function(r,l){var u=l.map(i),p=l.map(n);s[r]=function(i,n,r,s){i=""+i;var c=r.options,d=i.split("-");s||(s=0),e.each(u,function(e,i){if(e>=s){var u=o[i](d,r);if(2>d.length||u.enabled>1||a[r.type]===l[e])return n.element.attr({"data-currentview":p[e]}).addClass("ws-size-"+c.size).data("pickercontent",{data:r,content:u,values:d}),n.bodyElement.html(u.main),u.prev?n.prevElement.attr(u.prev).prop({disabled:!1}):n.prevElement.removeAttr("data-action").prop({disabled:!0}),u.next?n.nextElement.attr(u.next).prop({disabled:!1}):n.nextElement.removeAttr("data-action").prop({disabled:!0}),t[u.type]&&new t[u.type](n.bodyElement.children(),n,u),n.element.trigger("pickerchange"),!1}})}})}(),o.showPickerContent=function(e,t){var i=e.options;e._popoverinit||(o.commonInit(e,t),o.commonDateInit(e,t)),!e._popoverinit||i.restartView?s.setYearList(i.defValue||i.value,t,e,i.startView):s[t.element.attr("data-currentview")||"setYearList"](i.defValue||i.value,t,e,0),e._popoverinit=!0},o.color.showPickerContent=function(){var i,n,a,r=e('<div class="ws-jpicker" />'),l={setPicker:function(t,i){t||(t="active");var n=i.parseValue().replace(/^#/,"");n+=i.alpha.length?e.wsjPicker.ColorMethods.intToHex((i.alpha.prop("value")||1)*(255/(i.alpha.prop("max")||1))):"ff",a.color[t].val("ahex",n)},setInputColor:function(e,t){var i=e.val(),n="#"+i.hex;return t.alpha.length&&t.alpha.prop("value",i.a/(255/(t.alpha.prop("max")||1))),s.changeInput(n,t.popover,t),e.val()}},u=function(e,t,i){i==n&&l[e]&&l[e](t,i)},p=function(o){o.popover,o!=n&&(n&&n.popover.hide(),n=o,o.popover.contentElement.html(r),i&&u("setPicker","current",o)),i||(e.fn.wsjPicker.defaults.images.clientPath=t.cfg.basePath+"jpicker/images/",r.wsjPicker({window:{title:""}},function(e){u("setInputColor",e,n)},!1,function(e){s.cancel("#"+e.val().hex,n.popover,n)}),a=r.data("wsjPicker"),i=!0)};return function(t){t._popoverinit||(o.commonInit(t,t.popover),o.commonColorInit(t));var i=e(t.orig).data("alphacontrol");t.alpha=i?e("#"+i):e([]),p(t),t.alpha.length?r.removeClass("no-alpha-picker"):(e("input.alpha-radio:checked",r).each(function(){e("input.hue-radio",r).trigger("click")}),r.addClass("no-alpha-picker")),u("setPicker","",t),t._popoverinit=!0}}(),o.commonDateInit=function(i,a){var r=function(){return e(this).is(".othermonth")&&"pointer"!=e(this).css("cursor")||a.actionFn({"data-action":e.attr(this,"data-action"),value:e(this).val()||e.attr(this,"value")}),!1},l=(new Date).getTime(),u=function(i){var n=[],r="",s="";i.options=data.getOptions()||{},e("div.ws-options",a.contentElement).remove(),e.each(i.options[0],function(e,t){var a=o.isInRange(e.split("-"),i.maxS,i.minS)?"":' disabled="" ';n.push('<li role="presentation"><button value="'+e+'" '+a+' data-action="changeInput" tabindex="-1"  role="option">'+(t||data.formatValue(e,!1))+"</button></li>")}),n.length&&(l++,i.options[1]&&(s="datalist-"+l,r='<h5 id="'+s+'">'+i.options[1]+"</h5>",s=' aria-labelledbyid="'+s+'" '),new t.ListBox(e('<div class="ws-options">'+r+'<ul role="listbox" '+s+">"+n.join("")+"</div>").insertAfter(a.bodyElement)[0],a,{noFocus:!0}))},c=function(){if(a.isDirty){var i=data.options;i.maxS=i.max.split("-"),i.minS=i.min.split("-"),e("button",a.buttonRow).each(function(){var n;e(this).is(".ws-empty")?(n=m.date.clear,n||(n=f[""].date.clear||"clear",t.warn("could not get clear text from form cfg"))):e(this).is(".ws-current")&&(n=(m[data.type]||{}).currentText,n||(n=(f[""][[data.type]]||{}).currentText||"current",t.warn("could not get currentText from form cfg")),e.prop(this,"disabled",!o.isInRange(p[data.type].split("-"),i.maxS,i.minS))),n&&(e(this).text(n).attr({"aria-label":n}),t.assumeARIA&&e.attr(this,"aria-label",n))}),a.nextElement.attr({"aria-label":m.date.nextText}),e("> span",a.nextElement).html(m.date.nextText),a.prevElement.attr({"aria-label":m.date.prevText}),e("> span",a.prevElement).html(m.date.prevText),u(i,i.maxS,i.minS)}e("button.ws-empty",a.buttonRow).prop("disabled",e.prop(data.orig,"required")),a.isDirty=!1};a.actionFn=function(e){s[e["data-action"]]?s[e["data-action"]](e.value,a,data,0):t.warn("no action for "+e["data-action"])},a.contentElement.html('<button class="ws-prev" tabindex="0"><span></span></button> <button class="ws-next" tabindex="0"><span></span></button><div class="ws-picker-body"></div><div class="ws-button-row"><button type="button" class="ws-current" data-action="changeInput" value="'+p[data.type]+'" tabindex="0"></button> <button type="button" data-action="changeInput" value="" class="ws-empty" tabindex="0"></button></div>'),a.nextElement=e("button.ws-next",a.contentElement),a.prevElement=e("button.ws-prev",a.contentElement),a.bodyElement=e("div.ws-picker-body",a.contentElement),a.buttonRow=e("div.ws-button-row",a.contentElement),a.element.on("updatepickercontent",c),a.contentElement.on("click","button[data-action]",r).on("change","select[data-action]",r),e(data.options.orig).on("input",function(){var e;data.options.updateOnInput&&a.isVisible&&data.options.value&&(e=a.element.attr("data-currentview"))&&s[e](data.options.value,a,data,0)}),e(n).onTrigger("wslocalechange",data._propertyChange)},o.commonColorInit=function(t){var i=t.popover;i.element.on({wspopovershow:function(){t.element.triggerHandler("wsupdatevalue"),c.call(t,e("input.Hex",i.element))}})},o.commonInit=function(t,i){var a;i.isDirty=!0,i.element.on("updatepickercontent pickerchange",function(){a=!1}),i.contentElement.on({keydown:function(n){if(9==n.keyCode){a||(a=e('input:not(:disabled), [tabindex="0"]:not(:disabled)',this).filter(":visible"));var r=a.index(n.target);if(n.shiftKey&&0>=r)return a.last().focus(),!1;if(!n.shiftKey&&r>=a.length-1)return a.first().focus(),!1}else if(27==n.keyCode)return t.element.getShadowFocusElement().focus(),i.hide(),!1}}),t._propertyChange=function(){var e,t=function(){i.isVisible&&i.element.triggerHandler("updatepickercontent")};return function(n){"value"!=n&&(i.isDirty=!0,i.isVisible&&(clearTimeout(e),e=setTimeout(t,9)))}}(),i.activeElement=e([]),i.activateElement=function(t){t=e(t),t[0]!=i.activeElement[0]&&(i.activeElement.removeClass("ws-focus"),t.addClass("ws-focus")),i.activeElement=t},i.element.on({wspopoverbeforeshow:function(){t.element.triggerHandler("wsupdatevalue"),i.element.triggerHandler("updatepickercontent")}}),e(t.orig).on("remove",function(a){a.originalEvent||(e(n).off("wslocalechange",t._propertyChange),i.element.remove())})}});